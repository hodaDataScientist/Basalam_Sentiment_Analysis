{"cells":[{"cell_type":"code","execution_count":1,"metadata":{"id":"LJxkorj9X1Pg","executionInfo":{"status":"ok","timestamp":1732784035791,"user_tz":-210,"elapsed":4924,"user":{"displayName":"Hoda Nayebi","userId":"08056384129491287285"}}},"outputs":[],"source":["import numpy as np\n","import pandas as pd\n","import matplotlib.pyplot as plt\n","import seaborn as sns\n","import warnings\n","warnings.filterwarnings('ignore')"]},{"cell_type":"code","execution_count":2,"metadata":{"cellView":"form","colab":{"base_uri":"https://localhost:8080/"},"collapsed":true,"id":"Ga0NWCPPVbd_","outputId":"d9ca532e-ab2d-4aa4-c5a4-315893b0cb06","executionInfo":{"status":"ok","timestamp":1732784219921,"user_tz":-210,"elapsed":48413,"user":{"displayName":"Hoda Nayebi","userId":"08056384129491287285"}}},"outputs":[{"output_type":"stream","name":"stdout","text":["Collecting opendatasets\n","  Downloading opendatasets-0.1.22-py3-none-any.whl.metadata (9.2 kB)\n","Requirement already satisfied: tqdm in /usr/local/lib/python3.10/dist-packages (from opendatasets) (4.66.6)\n","Requirement already satisfied: kaggle in /usr/local/lib/python3.10/dist-packages (from opendatasets) (1.6.17)\n","Requirement already satisfied: click in /usr/local/lib/python3.10/dist-packages (from opendatasets) (8.1.7)\n","Requirement already satisfied: six>=1.10 in /usr/local/lib/python3.10/dist-packages (from kaggle->opendatasets) (1.16.0)\n","Requirement already satisfied: certifi>=2023.7.22 in /usr/local/lib/python3.10/dist-packages (from kaggle->opendatasets) (2024.8.30)\n","Requirement already satisfied: python-dateutil in /usr/local/lib/python3.10/dist-packages (from kaggle->opendatasets) (2.8.2)\n","Requirement already satisfied: requests in /usr/local/lib/python3.10/dist-packages (from kaggle->opendatasets) (2.32.3)\n","Requirement already satisfied: python-slugify in /usr/local/lib/python3.10/dist-packages (from kaggle->opendatasets) (8.0.4)\n","Requirement already satisfied: urllib3 in /usr/local/lib/python3.10/dist-packages (from kaggle->opendatasets) (2.2.3)\n","Requirement already satisfied: bleach in /usr/local/lib/python3.10/dist-packages (from kaggle->opendatasets) (6.2.0)\n","Requirement already satisfied: webencodings in /usr/local/lib/python3.10/dist-packages (from bleach->kaggle->opendatasets) (0.5.1)\n","Requirement already satisfied: text-unidecode>=1.3 in /usr/local/lib/python3.10/dist-packages (from python-slugify->kaggle->opendatasets) (1.3)\n","Requirement already satisfied: charset-normalizer<4,>=2 in /usr/local/lib/python3.10/dist-packages (from requests->kaggle->opendatasets) (3.4.0)\n","Requirement already satisfied: idna<4,>=2.5 in /usr/local/lib/python3.10/dist-packages (from requests->kaggle->opendatasets) (3.10)\n","Downloading opendatasets-0.1.22-py3-none-any.whl (15 kB)\n","Installing collected packages: opendatasets\n","Successfully installed opendatasets-0.1.22\n","Please provide your Kaggle credentials to download this dataset. Learn more: http://bit.ly/kaggle-creds\n","Your Kaggle username: hodanayebi\n","Your Kaggle Key: ··········\n","Dataset URL: https://www.kaggle.com/datasets/radeai/basalam-comments-and-products\n","Downloading basalam-comments-and-products.zip to ./basalam-comments-and-products\n"]},{"output_type":"stream","name":"stderr","text":["100%|██████████| 599M/599M [00:05<00:00, 116MB/s]\n"]},{"output_type":"stream","name":"stdout","text":["\n","Dataset downloaded successfully!\n"]}],"source":["# @title Download data from kaggle\n","\n","!pip install opendatasets\n","\n","import opendatasets as od\n","\n","def download_water_potability_data(url):\n","    try:\n","        od.download(url)\n","        print(\"Dataset downloaded successfully!\")\n","    except Exception as e:\n","        print(f\"An error occurred: {e}\")\n","\n","url = 'https://www.kaggle.com/datasets/radeai/basalam-comments-and-products/data?select=BaSalam.reviews.csv'\n","\n","download_water_potability_data(url)"]},{"cell_type":"code","execution_count":3,"metadata":{"executionInfo":{"elapsed":128912,"status":"ok","timestamp":1732784376838,"user":{"displayName":"Hoda Nayebi","userId":"08056384129491287285"},"user_tz":-210},"id":"XbXwZ4B3XtrY","collapsed":true},"outputs":[],"source":["# @title importing review-products datasets\n","\n","df = pd.read_csv('/content/basalam-comments-and-products/BaSalam.reviews.csv')\n","df_pro = pd.read_csv('/content/basalam-comments-and-products/BaSalam.products.csv')\n","# df.head()"]},{"cell_type":"code","source":["df.to_csv('/content/drive/MyDrive/Basalam/Basalam_comments_original.csv')"],"metadata":{"id":"Hp50OD4I_Zjo","executionInfo":{"status":"ok","timestamp":1732784487887,"user_tz":-210,"elapsed":93996,"user":{"displayName":"Hoda Nayebi","userId":"08056384129491287285"}}},"execution_count":4,"outputs":[]},{"cell_type":"markdown","metadata":{"id":"XPwtm5wwMXfY"},"source":["## Preprocessing Steps"]},{"cell_type":"code","execution_count":null,"metadata":{"cellView":"form","colab":{"base_uri":"https://localhost:8080/","height":1000},"executionInfo":{"elapsed":4801,"status":"ok","timestamp":1731183607952,"user":{"displayName":"Hoda Nayebi","userId":"08056384129491287285"},"user_tz":480},"id":"oUwh99uhlPhb","outputId":"f63d8d0c-11e7-4fbd-d328-abad3cad467f"},"outputs":[{"data":{"text/html":["<style type=\"text/css\">\n","#T_3e1b5_row0_col3, #T_3e1b5_row1_col3, #T_3e1b5_row2_col3, #T_3e1b5_row3_col3, #T_3e1b5_row4_col3, #T_3e1b5_row5_col3, #T_3e1b5_row6_col3, #T_3e1b5_row7_col3, #T_3e1b5_row8_col3, #T_3e1b5_row9_col3, #T_3e1b5_row11_col3, #T_3e1b5_row12_col3, #T_3e1b5_row13_col3, #T_3e1b5_row14_col3, #T_3e1b5_row15_col3, #T_3e1b5_row16_col3, #T_3e1b5_row17_col3, #T_3e1b5_row18_col3, #T_3e1b5_row19_col3 {\n","  background-color: #ebf3eb;\n","  color: #000000;\n","}\n","#T_3e1b5_row10_col3 {\n","  background-color: #daebda;\n","  color: #000000;\n","}\n","#T_3e1b5_row20_col3 {\n","  background-color: #339933;\n","  color: #f1f1f1;\n","}\n","#T_3e1b5_row21_col3 {\n","  background-color: #8bc48b;\n","  color: #000000;\n","}\n","#T_3e1b5_row22_col3 {\n","  background-color: #118811;\n","  color: #f1f1f1;\n","}\n","#T_3e1b5_row23_col3 {\n","  background-color: #0f870f;\n","  color: #f1f1f1;\n","}\n","#T_3e1b5_row24_col3, #T_3e1b5_row30_col3 {\n","  background-color: #0c860c;\n","  color: #f1f1f1;\n","}\n","#T_3e1b5_row25_col3 {\n","  background-color: #088408;\n","  color: #f1f1f1;\n","}\n","#T_3e1b5_row26_col3, #T_3e1b5_row27_col3, #T_3e1b5_row28_col3, #T_3e1b5_row29_col3 {\n","  background-color: #008000;\n","  color: #f1f1f1;\n","}\n","</style>\n","<table id=\"T_3e1b5\" class=\"dataframe\">\n","  <thead>\n","    <tr>\n","      <th class=\"blank level0\" >&nbsp;</th>\n","      <th id=\"T_3e1b5_level0_col0\" class=\"col_heading level0 col0\" >columns</th>\n","      <th id=\"T_3e1b5_level0_col1\" class=\"col_heading level0 col1\" >Type</th>\n","      <th id=\"T_3e1b5_level0_col2\" class=\"col_heading level0 col2\" >Total null</th>\n","      <th id=\"T_3e1b5_level0_col3\" class=\"col_heading level0 col3\" >%</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th id=\"T_3e1b5_level0_row0\" class=\"row_heading level0 row0\" >0</th>\n","      <td id=\"T_3e1b5_row0_col0\" class=\"data row0 col0\" >_id</td>\n","      <td id=\"T_3e1b5_row0_col1\" class=\"data row0 col1\" >object</td>\n","      <td id=\"T_3e1b5_row0_col2\" class=\"data row0 col2\" >0</td>\n","      <td id=\"T_3e1b5_row0_col3\" class=\"data row0 col3\" >0.00</td>\n","    </tr>\n","    <tr>\n","      <th id=\"T_3e1b5_level0_row1\" class=\"row_heading level0 row1\" >1</th>\n","      <td id=\"T_3e1b5_row1_col0\" class=\"data row1 col0\" >productId</td>\n","      <td id=\"T_3e1b5_row1_col1\" class=\"data row1 col1\" >int64</td>\n","      <td id=\"T_3e1b5_row1_col2\" class=\"data row1 col2\" >0</td>\n","      <td id=\"T_3e1b5_row1_col3\" class=\"data row1 col3\" >0.00</td>\n","    </tr>\n","    <tr>\n","      <th id=\"T_3e1b5_level0_row2\" class=\"row_heading level0 row2\" >2</th>\n","      <td id=\"T_3e1b5_row2_col0\" class=\"data row2 col0\" >star</td>\n","      <td id=\"T_3e1b5_row2_col1\" class=\"data row2 col1\" >int64</td>\n","      <td id=\"T_3e1b5_row2_col2\" class=\"data row2 col2\" >0</td>\n","      <td id=\"T_3e1b5_row2_col3\" class=\"data row2 col3\" >0.00</td>\n","    </tr>\n","    <tr>\n","      <th id=\"T_3e1b5_level0_row3\" class=\"row_heading level0 row3\" >3</th>\n","      <td id=\"T_3e1b5_row3_col0\" class=\"data row3 col0\" >user_id</td>\n","      <td id=\"T_3e1b5_row3_col1\" class=\"data row3 col1\" >int64</td>\n","      <td id=\"T_3e1b5_row3_col2\" class=\"data row3 col2\" >0</td>\n","      <td id=\"T_3e1b5_row3_col3\" class=\"data row3 col3\" >0.00</td>\n","    </tr>\n","    <tr>\n","      <th id=\"T_3e1b5_level0_row4\" class=\"row_heading level0 row4\" >4</th>\n","      <td id=\"T_3e1b5_row4_col0\" class=\"data row4 col0\" >isPost</td>\n","      <td id=\"T_3e1b5_row4_col1\" class=\"data row4 col1\" >bool</td>\n","      <td id=\"T_3e1b5_row4_col2\" class=\"data row4 col2\" >0</td>\n","      <td id=\"T_3e1b5_row4_col3\" class=\"data row4 col3\" >0.00</td>\n","    </tr>\n","    <tr>\n","      <th id=\"T_3e1b5_level0_row5\" class=\"row_heading level0 row5\" >5</th>\n","      <td id=\"T_3e1b5_row5_col0\" class=\"data row5 col0\" >isPublic</td>\n","      <td id=\"T_3e1b5_row5_col1\" class=\"data row5 col1\" >bool</td>\n","      <td id=\"T_3e1b5_row5_col2\" class=\"data row5 col2\" >0</td>\n","      <td id=\"T_3e1b5_row5_col3\" class=\"data row5 col3\" >0.00</td>\n","    </tr>\n","    <tr>\n","      <th id=\"T_3e1b5_level0_row6\" class=\"row_heading level0 row6\" >6</th>\n","      <td id=\"T_3e1b5_row6_col0\" class=\"data row6 col0\" >id</td>\n","      <td id=\"T_3e1b5_row6_col1\" class=\"data row6 col1\" >int64</td>\n","      <td id=\"T_3e1b5_row6_col2\" class=\"data row6 col2\" >0</td>\n","      <td id=\"T_3e1b5_row6_col3\" class=\"data row6 col3\" >0.00</td>\n","    </tr>\n","    <tr>\n","      <th id=\"T_3e1b5_level0_row7\" class=\"row_heading level0 row7\" >7</th>\n","      <td id=\"T_3e1b5_row7_col0\" class=\"data row7 col0\" >createdAt</td>\n","      <td id=\"T_3e1b5_row7_col1\" class=\"data row7 col1\" >object</td>\n","      <td id=\"T_3e1b5_row7_col2\" class=\"data row7 col2\" >0</td>\n","      <td id=\"T_3e1b5_row7_col3\" class=\"data row7 col3\" >0.00</td>\n","    </tr>\n","    <tr>\n","      <th id=\"T_3e1b5_level0_row8\" class=\"row_heading level0 row8\" >8</th>\n","      <td id=\"T_3e1b5_row8_col0\" class=\"data row8 col0\" >updatedAt</td>\n","      <td id=\"T_3e1b5_row8_col1\" class=\"data row8 col1\" >object</td>\n","      <td id=\"T_3e1b5_row8_col2\" class=\"data row8 col2\" >0</td>\n","      <td id=\"T_3e1b5_row8_col3\" class=\"data row8 col3\" >0.00</td>\n","    </tr>\n","    <tr>\n","      <th id=\"T_3e1b5_level0_row9\" class=\"row_heading level0 row9\" >9</th>\n","      <td id=\"T_3e1b5_row9_col0\" class=\"data row9 col0\" >hashId</td>\n","      <td id=\"T_3e1b5_row9_col1\" class=\"data row9 col1\" >object</td>\n","      <td id=\"T_3e1b5_row9_col2\" class=\"data row9 col2\" >0</td>\n","      <td id=\"T_3e1b5_row9_col3\" class=\"data row9 col3\" >0.00</td>\n","    </tr>\n","    <tr>\n","      <th id=\"T_3e1b5_level0_row10\" class=\"row_heading level0 row10\" >10</th>\n","      <td id=\"T_3e1b5_row10_col0\" class=\"data row10 col0\" >isPosted</td>\n","      <td id=\"T_3e1b5_row10_col1\" class=\"data row10 col1\" >object</td>\n","      <td id=\"T_3e1b5_row10_col2\" class=\"data row10 col2\" >245741</td>\n","      <td id=\"T_3e1b5_row10_col3\" class=\"data row10 col3\" >7.24</td>\n","    </tr>\n","    <tr>\n","      <th id=\"T_3e1b5_level0_row11\" class=\"row_heading level0 row11\" >11</th>\n","      <td id=\"T_3e1b5_row11_col0\" class=\"data row11 col0\" >isLikedByCurrentUser</td>\n","      <td id=\"T_3e1b5_row11_col1\" class=\"data row11 col1\" >bool</td>\n","      <td id=\"T_3e1b5_row11_col2\" class=\"data row11 col2\" >0</td>\n","      <td id=\"T_3e1b5_row11_col3\" class=\"data row11 col3\" >0.00</td>\n","    </tr>\n","    <tr>\n","      <th id=\"T_3e1b5_level0_row12\" class=\"row_heading level0 row12\" >12</th>\n","      <td id=\"T_3e1b5_row12_col0\" class=\"data row12 col0\" >isDislikedByCurrentUser</td>\n","      <td id=\"T_3e1b5_row12_col1\" class=\"data row12 col1\" >bool</td>\n","      <td id=\"T_3e1b5_row12_col2\" class=\"data row12 col2\" >0</td>\n","      <td id=\"T_3e1b5_row12_col3\" class=\"data row12 col3\" >0.00</td>\n","    </tr>\n","    <tr>\n","      <th id=\"T_3e1b5_level0_row13\" class=\"row_heading level0 row13\" >13</th>\n","      <td id=\"T_3e1b5_row13_col0\" class=\"data row13 col0\" >likeCount</td>\n","      <td id=\"T_3e1b5_row13_col1\" class=\"data row13 col1\" >int64</td>\n","      <td id=\"T_3e1b5_row13_col2\" class=\"data row13 col2\" >0</td>\n","      <td id=\"T_3e1b5_row13_col3\" class=\"data row13 col3\" >0.00</td>\n","    </tr>\n","    <tr>\n","      <th id=\"T_3e1b5_level0_row14\" class=\"row_heading level0 row14\" >14</th>\n","      <td id=\"T_3e1b5_row14_col0\" class=\"data row14 col0\" >dislikeCount</td>\n","      <td id=\"T_3e1b5_row14_col1\" class=\"data row14 col1\" >int64</td>\n","      <td id=\"T_3e1b5_row14_col2\" class=\"data row14 col2\" >0</td>\n","      <td id=\"T_3e1b5_row14_col3\" class=\"data row14 col3\" >0.00</td>\n","    </tr>\n","    <tr>\n","      <th id=\"T_3e1b5_level0_row15\" class=\"row_heading level0 row15\" >15</th>\n","      <td id=\"T_3e1b5_row15_col0\" class=\"data row15 col0\" >attachments</td>\n","      <td id=\"T_3e1b5_row15_col1\" class=\"data row15 col1\" >object</td>\n","      <td id=\"T_3e1b5_row15_col2\" class=\"data row15 col2\" >0</td>\n","      <td id=\"T_3e1b5_row15_col3\" class=\"data row15 col3\" >0.00</td>\n","    </tr>\n","    <tr>\n","      <th id=\"T_3e1b5_level0_row16\" class=\"row_heading level0 row16\" >16</th>\n","      <td id=\"T_3e1b5_row16_col0\" class=\"data row16 col0\" >history_count</td>\n","      <td id=\"T_3e1b5_row16_col1\" class=\"data row16 col1\" >int64</td>\n","      <td id=\"T_3e1b5_row16_col2\" class=\"data row16 col2\" >0</td>\n","      <td id=\"T_3e1b5_row16_col3\" class=\"data row16 col3\" >0.00</td>\n","    </tr>\n","    <tr>\n","      <th id=\"T_3e1b5_level0_row17\" class=\"row_heading level0 row17\" >17</th>\n","      <td id=\"T_3e1b5_row17_col0\" class=\"data row17 col0\" >user_id_of_user</td>\n","      <td id=\"T_3e1b5_row17_col1\" class=\"data row17 col1\" >int64</td>\n","      <td id=\"T_3e1b5_row17_col2\" class=\"data row17 col2\" >0</td>\n","      <td id=\"T_3e1b5_row17_col3\" class=\"data row17 col3\" >0.00</td>\n","    </tr>\n","    <tr>\n","      <th id=\"T_3e1b5_level0_row18\" class=\"row_heading level0 row18\" >18</th>\n","      <td id=\"T_3e1b5_row18_col0\" class=\"data row18 col0\" >name_of_user</td>\n","      <td id=\"T_3e1b5_row18_col1\" class=\"data row18 col1\" >object</td>\n","      <td id=\"T_3e1b5_row18_col2\" class=\"data row18 col2\" >5</td>\n","      <td id=\"T_3e1b5_row18_col3\" class=\"data row18 col3\" >0.00</td>\n","    </tr>\n","    <tr>\n","      <th id=\"T_3e1b5_level0_row19\" class=\"row_heading level0 row19\" >19</th>\n","      <td id=\"T_3e1b5_row19_col0\" class=\"data row19 col0\" >hash_id_of_user</td>\n","      <td id=\"T_3e1b5_row19_col1\" class=\"data row19 col1\" >object</td>\n","      <td id=\"T_3e1b5_row19_col2\" class=\"data row19 col2\" >0</td>\n","      <td id=\"T_3e1b5_row19_col3\" class=\"data row19 col3\" >0.00</td>\n","    </tr>\n","    <tr>\n","      <th id=\"T_3e1b5_level0_row20\" class=\"row_heading level0 row20\" >20</th>\n","      <td id=\"T_3e1b5_row20_col0\" class=\"data row20 col0\" >photo_of_user</td>\n","      <td id=\"T_3e1b5_row20_col1\" class=\"data row20 col1\" >object</td>\n","      <td id=\"T_3e1b5_row20_col2\" class=\"data row20 col2\" >2660831</td>\n","      <td id=\"T_3e1b5_row20_col3\" class=\"data row20 col3\" >78.41</td>\n","    </tr>\n","    <tr>\n","      <th id=\"T_3e1b5_level0_row21\" class=\"row_heading level0 row21\" >21</th>\n","      <td id=\"T_3e1b5_row21_col0\" class=\"data row21 col0\" >description</td>\n","      <td id=\"T_3e1b5_row21_col1\" class=\"data row21 col1\" >object</td>\n","      <td id=\"T_3e1b5_row21_col2\" class=\"data row21 col2\" >1391786</td>\n","      <td id=\"T_3e1b5_row21_col3\" class=\"data row21 col3\" >41.01</td>\n","    </tr>\n","    <tr>\n","      <th id=\"T_3e1b5_level0_row22\" class=\"row_heading level0 row22\" >22</th>\n","      <td id=\"T_3e1b5_row22_col0\" class=\"data row22 col0\" >reason_ids[0]</td>\n","      <td id=\"T_3e1b5_row22_col1\" class=\"data row22 col1\" >float64</td>\n","      <td id=\"T_3e1b5_row22_col2\" class=\"data row22 col2\" >3152350</td>\n","      <td id=\"T_3e1b5_row22_col3\" class=\"data row22 col3\" >92.89</td>\n","    </tr>\n","    <tr>\n","      <th id=\"T_3e1b5_level0_row23\" class=\"row_heading level0 row23\" >23</th>\n","      <td id=\"T_3e1b5_row23_col0\" class=\"data row23 col0\" >reason_ids[1]</td>\n","      <td id=\"T_3e1b5_row23_col1\" class=\"data row23 col1\" >float64</td>\n","      <td id=\"T_3e1b5_row23_col2\" class=\"data row23 col2\" >3178940</td>\n","      <td id=\"T_3e1b5_row23_col3\" class=\"data row23 col3\" >93.68</td>\n","    </tr>\n","    <tr>\n","      <th id=\"T_3e1b5_level0_row24\" class=\"row_heading level0 row24\" >24</th>\n","      <td id=\"T_3e1b5_row24_col0\" class=\"data row24 col0\" >reason_ids[2]</td>\n","      <td id=\"T_3e1b5_row24_col1\" class=\"data row24 col1\" >float64</td>\n","      <td id=\"T_3e1b5_row24_col2\" class=\"data row24 col2\" >3218274</td>\n","      <td id=\"T_3e1b5_row24_col3\" class=\"data row24 col3\" >94.83</td>\n","    </tr>\n","    <tr>\n","      <th id=\"T_3e1b5_level0_row25\" class=\"row_heading level0 row25\" >25</th>\n","      <td id=\"T_3e1b5_row25_col0\" class=\"data row25 col0\" >reason_ids[3]</td>\n","      <td id=\"T_3e1b5_row25_col1\" class=\"data row25 col1\" >float64</td>\n","      <td id=\"T_3e1b5_row25_col2\" class=\"data row25 col2\" >3262435</td>\n","      <td id=\"T_3e1b5_row25_col3\" class=\"data row25 col3\" >96.14</td>\n","    </tr>\n","    <tr>\n","      <th id=\"T_3e1b5_level0_row26\" class=\"row_heading level0 row26\" >26</th>\n","      <td id=\"T_3e1b5_row26_col0\" class=\"data row26 col0\" >reason_ids[4]</td>\n","      <td id=\"T_3e1b5_row26_col1\" class=\"data row26 col1\" >float64</td>\n","      <td id=\"T_3e1b5_row26_col2\" class=\"data row26 col2\" >3393314</td>\n","      <td id=\"T_3e1b5_row26_col3\" class=\"data row26 col3\" >99.99</td>\n","    </tr>\n","    <tr>\n","      <th id=\"T_3e1b5_level0_row27\" class=\"row_heading level0 row27\" >27</th>\n","      <td id=\"T_3e1b5_row27_col0\" class=\"data row27 col0\" >reason_ids[5]</td>\n","      <td id=\"T_3e1b5_row27_col1\" class=\"data row27 col1\" >float64</td>\n","      <td id=\"T_3e1b5_row27_col2\" class=\"data row27 col2\" >3393540</td>\n","      <td id=\"T_3e1b5_row27_col3\" class=\"data row27 col3\" >100.00</td>\n","    </tr>\n","    <tr>\n","      <th id=\"T_3e1b5_level0_row28\" class=\"row_heading level0 row28\" >28</th>\n","      <td id=\"T_3e1b5_row28_col0\" class=\"data row28 col0\" >reason_ids[6]</td>\n","      <td id=\"T_3e1b5_row28_col1\" class=\"data row28 col1\" >float64</td>\n","      <td id=\"T_3e1b5_row28_col2\" class=\"data row28 col2\" >3393549</td>\n","      <td id=\"T_3e1b5_row28_col3\" class=\"data row28 col3\" >100.00</td>\n","    </tr>\n","    <tr>\n","      <th id=\"T_3e1b5_level0_row29\" class=\"row_heading level0 row29\" >29</th>\n","      <td id=\"T_3e1b5_row29_col0\" class=\"data row29 col0\" >reason_ids[7]</td>\n","      <td id=\"T_3e1b5_row29_col1\" class=\"data row29 col1\" >float64</td>\n","      <td id=\"T_3e1b5_row29_col2\" class=\"data row29 col2\" >3393554</td>\n","      <td id=\"T_3e1b5_row29_col3\" class=\"data row29 col3\" >100.00</td>\n","    </tr>\n","    <tr>\n","      <th id=\"T_3e1b5_level0_row30\" class=\"row_heading level0 row30\" >30</th>\n","      <td id=\"T_3e1b5_row30_col0\" class=\"data row30 col0\" >variation_metadata</td>\n","      <td id=\"T_3e1b5_row30_col1\" class=\"data row30 col1\" >object</td>\n","      <td id=\"T_3e1b5_row30_col2\" class=\"data row30 col2\" >3209873</td>\n","      <td id=\"T_3e1b5_row30_col3\" class=\"data row30 col3\" >94.59</td>\n","    </tr>\n","  </tbody>\n","</table>\n"],"text/plain":["<pandas.io.formats.style.Styler at 0x7d3b1127fa60>"]},"execution_count":21,"metadata":{},"output_type":"execute_result"}],"source":["# @title 1) Checking null values\n","\n","percentage_result = df.isnull().sum()/df.shape[0] * 100\n","column_type = [df[col].dtype for col in df.columns]\n","# create a DataFrame to show case the result\n","percentage_result = pd.DataFrame({\"columns\": percentage_result.keys(), \"Type\" : column_type ,\"Total null\" :  df.isnull().sum() ,\"%\": percentage_result.round(2) })\n","percentage_result.reset_index(drop=True, inplace=True)\n","cm = sns.light_palette(\"green\", as_cmap=True)\n","percentage_result.style.background_gradient(cmap=cm , subset=['%']).format(precision=2)"]},{"cell_type":"code","execution_count":null,"metadata":{"cellView":"form","colab":{"base_uri":"https://localhost:8080/","height":489},"executionInfo":{"elapsed":1104,"status":"ok","timestamp":1731181591228,"user":{"displayName":"Hoda Nayebi","userId":"08056384129491287285"},"user_tz":480},"id":"IunTQ3KyX8T4","outputId":"d2c3c42a-fcb6-45f4-f402-bf27f39e9fa5"},"outputs":[{"data":{"text/html":["<div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>count</th>\n","    </tr>\n","    <tr>\n","      <th>variation_metadata</th>\n","      <th></th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>[{'id': 155294477, 'properties': [{'value': {'id': 121, 'title': '40', 'value': '40'}, 'property': {'id': 2, 'type': 'text', 'title': 'سایز'}}]}]</th>\n","      <td>1</td>\n","    </tr>\n","    <tr>\n","      <th>[{'id': 122700864, 'properties': [{'value': {'id': 263, 'title': 'مشکی', 'value': '#000000'}, 'property': {'id': 1, 'type': 'color', 'title': 'رنگ'}}]}]</th>\n","      <td>1</td>\n","    </tr>\n","    <tr>\n","      <th>[{'id': 153613833, 'properties': [{'value': {'id': 295, 'title': 'عسلی', 'value': '#d47208'}, 'property': {'id': 1, 'type': 'color', 'title': 'رنگ'}}]}]</th>\n","      <td>1</td>\n","    </tr>\n","    <tr>\n","      <th>[{'id': 125890220, 'properties': [{'value': {'id': 303, 'title': 'قهوه ای سوخته', 'value': '#341c02'}, 'property': {'id': 1, 'type': 'color', 'title': 'رنگ'}}]}]</th>\n","      <td>1</td>\n","    </tr>\n","    <tr>\n","      <th>[{'id': 98302811, 'properties': [{'value': {'id': 263, 'title': 'سیاه', 'value': '#000000'}, 'property': {'id': 1, 'type': 'color', 'title': 'رنگ'}}]}]</th>\n","      <td>1</td>\n","    </tr>\n","    <tr>\n","      <th>...</th>\n","      <td>...</td>\n","    </tr>\n","    <tr>\n","      <th>[{'id': 148004477, 'properties': [{'value': {'id': 279, 'title': 'صورتی', 'value': '#ffc0cb'}, 'property': {'id': 1, 'type': 'color', 'title': 'رنگ'}}]}]</th>\n","      <td>1</td>\n","    </tr>\n","    <tr>\n","      <th>[{'id': 151335586, 'properties': [{'value': {'id': 331, 'title': 'آبی', 'value': '#0000ff'}, 'property': {'id': 1, 'type': 'color', 'title': 'رنگ'}}]}]</th>\n","      <td>1</td>\n","    </tr>\n","    <tr>\n","      <th>[{'id': 80774530, 'properties': [{'value': {'id': 257, 'title': 'نقره ای', 'value': '#d3d3d3'}, 'property': {'id': 1, 'type': 'color', 'title': 'رنگ'}}]}]</th>\n","      <td>1</td>\n","    </tr>\n","    <tr>\n","      <th>[{'id': 141142099, 'properties': [{'value': {'id': 269, 'title': 'طلایی', 'value': '#FFD700'}, 'property': {'id': 1, 'type': 'color', 'title': 'رنگ'}}]}]</th>\n","      <td>1</td>\n","    </tr>\n","    <tr>\n","      <th>[{'id': 155479324, 'properties': [{'value': {'id': 254, 'title': 'سفید', 'value': '#ffffff'}, 'property': {'id': 1, 'type': 'color', 'title': 'رنگ'}}]}]</th>\n","      <td>1</td>\n","    </tr>\n","  </tbody>\n","</table>\n","<p>183701 rows × 1 columns</p>\n","</div><br><label><b>dtype:</b> int64</label>"],"text/plain":["variation_metadata\n","[{'id': 155294477, 'properties': [{'value': {'id': 121, 'title': '40', 'value': '40'}, 'property': {'id': 2, 'type': 'text', 'title': 'سایز'}}]}]                    1\n","[{'id': 122700864, 'properties': [{'value': {'id': 263, 'title': 'مشکی', 'value': '#000000'}, 'property': {'id': 1, 'type': 'color', 'title': 'رنگ'}}]}]             1\n","[{'id': 153613833, 'properties': [{'value': {'id': 295, 'title': 'عسلی', 'value': '#d47208'}, 'property': {'id': 1, 'type': 'color', 'title': 'رنگ'}}]}]             1\n","[{'id': 125890220, 'properties': [{'value': {'id': 303, 'title': 'قهوه ای سوخته', 'value': '#341c02'}, 'property': {'id': 1, 'type': 'color', 'title': 'رنگ'}}]}]    1\n","[{'id': 98302811, 'properties': [{'value': {'id': 263, 'title': 'سیاه', 'value': '#000000'}, 'property': {'id': 1, 'type': 'color', 'title': 'رنگ'}}]}]              1\n","                                                                                                                                                                    ..\n","[{'id': 148004477, 'properties': [{'value': {'id': 279, 'title': 'صورتی', 'value': '#ffc0cb'}, 'property': {'id': 1, 'type': 'color', 'title': 'رنگ'}}]}]            1\n","[{'id': 151335586, 'properties': [{'value': {'id': 331, 'title': 'آبی', 'value': '#0000ff'}, 'property': {'id': 1, 'type': 'color', 'title': 'رنگ'}}]}]              1\n","[{'id': 80774530, 'properties': [{'value': {'id': 257, 'title': 'نقره ای', 'value': '#d3d3d3'}, 'property': {'id': 1, 'type': 'color', 'title': 'رنگ'}}]}]           1\n","[{'id': 141142099, 'properties': [{'value': {'id': 269, 'title': 'طلایی', 'value': '#FFD700'}, 'property': {'id': 1, 'type': 'color', 'title': 'رنگ'}}]}]            1\n","[{'id': 155479324, 'properties': [{'value': {'id': 254, 'title': 'سفید', 'value': '#ffffff'}, 'property': {'id': 1, 'type': 'color', 'title': 'رنگ'}}]}]             1\n","Name: count, Length: 183701, dtype: int64"]},"execution_count":5,"metadata":{},"output_type":"execute_result"}],"source":["# @title Checking special columns values\n","\n","df['variation_metadata'].value_counts()"]},{"cell_type":"code","execution_count":null,"metadata":{"cellView":"form","colab":{"base_uri":"https://localhost:8080/","height":303},"executionInfo":{"elapsed":157596,"status":"ok","timestamp":1731184258037,"user":{"displayName":"Hoda Nayebi","userId":"08056384129491287285"},"user_tz":480},"id":"yirMxp88drOH","outputId":"97b1f09b-7995-4259-ebaa-7c8f2981c42b"},"outputs":[{"data":{"text/html":["<div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>count</th>\n","    </tr>\n","    <tr>\n","      <th>photo_count</th>\n","      <th></th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>3282901</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>90518</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>14088</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>6051</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>9</td>\n","    </tr>\n","    <tr>\n","      <th>6</th>\n","      <td>7</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div><br><label><b>dtype:</b> int64</label>"],"text/plain":["photo_count\n","0    3282901\n","1      90518\n","2      14088\n","3       6051\n","4          9\n","6          7\n","Name: count, dtype: int64"]},"execution_count":23,"metadata":{},"output_type":"execute_result"}],"source":["# @title Extracting photos has commented from metadata\n","\n","import json\n","import ast\n","\n","df['photo_count'] = df['attachments'].apply(lambda x: len(ast.literal_eval(x)['photos']) if 'photos' in ast.literal_eval(x) else 0)\n","\n","df['photo_count'].value_counts()"]},{"cell_type":"code","execution_count":null,"metadata":{"cellView":"form","colab":{"base_uri":"https://localhost:8080/","height":488},"executionInfo":{"elapsed":1653,"status":"ok","timestamp":1731186347109,"user":{"displayName":"Hoda Nayebi","userId":"08056384129491287285"},"user_tz":480},"id":"R3VJeWeXtZ9q","outputId":"273419c0-c03f-4446-b676-9c0eacde8de9"},"outputs":[{"data":{"text/html":["<style type=\"text/css\">\n","#T_f9cde_row0_col3, #T_f9cde_row1_col3, #T_f9cde_row2_col3, #T_f9cde_row3_col3, #T_f9cde_row4_col3, #T_f9cde_row5_col3, #T_f9cde_row6_col3, #T_f9cde_row7_col3, #T_f9cde_row8_col3, #T_f9cde_row9_col3, #T_f9cde_row10_col3, #T_f9cde_row11_col3, #T_f9cde_row12_col3, #T_f9cde_row13_col3 {\n","  background-color: #f0f0f3;\n","  color: #000000;\n","}\n","</style>\n","<table id=\"T_f9cde\" class=\"dataframe\">\n","  <thead>\n","    <tr>\n","      <th class=\"blank level0\" >&nbsp;</th>\n","      <th id=\"T_f9cde_level0_col0\" class=\"col_heading level0 col0\" >columns</th>\n","      <th id=\"T_f9cde_level0_col1\" class=\"col_heading level0 col1\" >Type</th>\n","      <th id=\"T_f9cde_level0_col2\" class=\"col_heading level0 col2\" >Total null</th>\n","      <th id=\"T_f9cde_level0_col3\" class=\"col_heading level0 col3\" >%</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th id=\"T_f9cde_level0_row0\" class=\"row_heading level0 row0\" >0</th>\n","      <td id=\"T_f9cde_row0_col0\" class=\"data row0 col0\" >_id</td>\n","      <td id=\"T_f9cde_row0_col1\" class=\"data row0 col1\" >object</td>\n","      <td id=\"T_f9cde_row0_col2\" class=\"data row0 col2\" >0</td>\n","      <td id=\"T_f9cde_row0_col3\" class=\"data row0 col3\" >0.00</td>\n","    </tr>\n","    <tr>\n","      <th id=\"T_f9cde_level0_row1\" class=\"row_heading level0 row1\" >1</th>\n","      <td id=\"T_f9cde_row1_col0\" class=\"data row1 col0\" >productId</td>\n","      <td id=\"T_f9cde_row1_col1\" class=\"data row1 col1\" >int64</td>\n","      <td id=\"T_f9cde_row1_col2\" class=\"data row1 col2\" >0</td>\n","      <td id=\"T_f9cde_row1_col3\" class=\"data row1 col3\" >0.00</td>\n","    </tr>\n","    <tr>\n","      <th id=\"T_f9cde_level0_row2\" class=\"row_heading level0 row2\" >2</th>\n","      <td id=\"T_f9cde_row2_col0\" class=\"data row2 col0\" >star</td>\n","      <td id=\"T_f9cde_row2_col1\" class=\"data row2 col1\" >int64</td>\n","      <td id=\"T_f9cde_row2_col2\" class=\"data row2 col2\" >0</td>\n","      <td id=\"T_f9cde_row2_col3\" class=\"data row2 col3\" >0.00</td>\n","    </tr>\n","    <tr>\n","      <th id=\"T_f9cde_level0_row3\" class=\"row_heading level0 row3\" >3</th>\n","      <td id=\"T_f9cde_row3_col0\" class=\"data row3 col0\" >user_id</td>\n","      <td id=\"T_f9cde_row3_col1\" class=\"data row3 col1\" >int64</td>\n","      <td id=\"T_f9cde_row3_col2\" class=\"data row3 col2\" >0</td>\n","      <td id=\"T_f9cde_row3_col3\" class=\"data row3 col3\" >0.00</td>\n","    </tr>\n","    <tr>\n","      <th id=\"T_f9cde_level0_row4\" class=\"row_heading level0 row4\" >4</th>\n","      <td id=\"T_f9cde_row4_col0\" class=\"data row4 col0\" >isPost</td>\n","      <td id=\"T_f9cde_row4_col1\" class=\"data row4 col1\" >bool</td>\n","      <td id=\"T_f9cde_row4_col2\" class=\"data row4 col2\" >0</td>\n","      <td id=\"T_f9cde_row4_col3\" class=\"data row4 col3\" >0.00</td>\n","    </tr>\n","    <tr>\n","      <th id=\"T_f9cde_level0_row5\" class=\"row_heading level0 row5\" >5</th>\n","      <td id=\"T_f9cde_row5_col0\" class=\"data row5 col0\" >isPublic</td>\n","      <td id=\"T_f9cde_row5_col1\" class=\"data row5 col1\" >bool</td>\n","      <td id=\"T_f9cde_row5_col2\" class=\"data row5 col2\" >0</td>\n","      <td id=\"T_f9cde_row5_col3\" class=\"data row5 col3\" >0.00</td>\n","    </tr>\n","    <tr>\n","      <th id=\"T_f9cde_level0_row6\" class=\"row_heading level0 row6\" >6</th>\n","      <td id=\"T_f9cde_row6_col0\" class=\"data row6 col0\" >createdAt</td>\n","      <td id=\"T_f9cde_row6_col1\" class=\"data row6 col1\" >object</td>\n","      <td id=\"T_f9cde_row6_col2\" class=\"data row6 col2\" >0</td>\n","      <td id=\"T_f9cde_row6_col3\" class=\"data row6 col3\" >0.00</td>\n","    </tr>\n","    <tr>\n","      <th id=\"T_f9cde_level0_row7\" class=\"row_heading level0 row7\" >7</th>\n","      <td id=\"T_f9cde_row7_col0\" class=\"data row7 col0\" >isLikedByCurrentUser</td>\n","      <td id=\"T_f9cde_row7_col1\" class=\"data row7 col1\" >bool</td>\n","      <td id=\"T_f9cde_row7_col2\" class=\"data row7 col2\" >0</td>\n","      <td id=\"T_f9cde_row7_col3\" class=\"data row7 col3\" >0.00</td>\n","    </tr>\n","    <tr>\n","      <th id=\"T_f9cde_level0_row8\" class=\"row_heading level0 row8\" >8</th>\n","      <td id=\"T_f9cde_row8_col0\" class=\"data row8 col0\" >isDislikedByCurrentUser</td>\n","      <td id=\"T_f9cde_row8_col1\" class=\"data row8 col1\" >bool</td>\n","      <td id=\"T_f9cde_row8_col2\" class=\"data row8 col2\" >0</td>\n","      <td id=\"T_f9cde_row8_col3\" class=\"data row8 col3\" >0.00</td>\n","    </tr>\n","    <tr>\n","      <th id=\"T_f9cde_level0_row9\" class=\"row_heading level0 row9\" >9</th>\n","      <td id=\"T_f9cde_row9_col0\" class=\"data row9 col0\" >likeCount</td>\n","      <td id=\"T_f9cde_row9_col1\" class=\"data row9 col1\" >int64</td>\n","      <td id=\"T_f9cde_row9_col2\" class=\"data row9 col2\" >0</td>\n","      <td id=\"T_f9cde_row9_col3\" class=\"data row9 col3\" >0.00</td>\n","    </tr>\n","    <tr>\n","      <th id=\"T_f9cde_level0_row10\" class=\"row_heading level0 row10\" >10</th>\n","      <td id=\"T_f9cde_row10_col0\" class=\"data row10 col0\" >dislikeCount</td>\n","      <td id=\"T_f9cde_row10_col1\" class=\"data row10 col1\" >int64</td>\n","      <td id=\"T_f9cde_row10_col2\" class=\"data row10 col2\" >0</td>\n","      <td id=\"T_f9cde_row10_col3\" class=\"data row10 col3\" >0.00</td>\n","    </tr>\n","    <tr>\n","      <th id=\"T_f9cde_level0_row11\" class=\"row_heading level0 row11\" >11</th>\n","      <td id=\"T_f9cde_row11_col0\" class=\"data row11 col0\" >history_count</td>\n","      <td id=\"T_f9cde_row11_col1\" class=\"data row11 col1\" >int64</td>\n","      <td id=\"T_f9cde_row11_col2\" class=\"data row11 col2\" >0</td>\n","      <td id=\"T_f9cde_row11_col3\" class=\"data row11 col3\" >0.00</td>\n","    </tr>\n","    <tr>\n","      <th id=\"T_f9cde_level0_row12\" class=\"row_heading level0 row12\" >12</th>\n","      <td id=\"T_f9cde_row12_col0\" class=\"data row12 col0\" >description</td>\n","      <td id=\"T_f9cde_row12_col1\" class=\"data row12 col1\" >object</td>\n","      <td id=\"T_f9cde_row12_col2\" class=\"data row12 col2\" >0</td>\n","      <td id=\"T_f9cde_row12_col3\" class=\"data row12 col3\" >0.00</td>\n","    </tr>\n","    <tr>\n","      <th id=\"T_f9cde_level0_row13\" class=\"row_heading level0 row13\" >13</th>\n","      <td id=\"T_f9cde_row13_col0\" class=\"data row13 col0\" >photo_count</td>\n","      <td id=\"T_f9cde_row13_col1\" class=\"data row13 col1\" >int64</td>\n","      <td id=\"T_f9cde_row13_col2\" class=\"data row13 col2\" >0</td>\n","      <td id=\"T_f9cde_row13_col3\" class=\"data row13 col3\" >0.00</td>\n","    </tr>\n","  </tbody>\n","</table>\n"],"text/plain":["<pandas.io.formats.style.Styler at 0x7d3b10c94130>"]},"execution_count":49,"metadata":{},"output_type":"execute_result"}],"source":["# @title Drop null values to have 2,001,788  clean data\n","\n","df.dropna(subset=['description'] , inplace=True)\n","\n","percentage_result = df.isnull().sum()/df.shape[0] * 100\n","column_type = [df[col].dtype for col in df.columns]\n","# create a DataFrame to show case the result\n","percentage_result = pd.DataFrame({\"columns\": percentage_result.keys(), \"Type\" : column_type ,\"Total null\" :  df.isnull().sum() ,\"%\": percentage_result.round(2) })\n","percentage_result.reset_index(drop=True, inplace=True)\n","cm = sns.light_palette(\"blue\", as_cmap=True)\n","percentage_result.style.background_gradient(cmap=cm , subset=['%']).format(precision=2)"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"xDI7IuWWmA8r"},"outputs":[],"source":["df = df[['_id' , 'productId' , 'star' , 'user_id' , 'isPost' , 'isPublic' ,'createdAt' , 'isLikedByCurrentUser', 'likeCount' , 'dislikeCount' ,'attachments' , 'history_count' , 'description']]"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":533},"executionInfo":{"elapsed":891,"status":"ok","timestamp":1731664320085,"user":{"displayName":"Hoda Nayebi","userId":"08056384129491287285"},"user_tz":480},"id":"IkjAsksIwJDS","outputId":"ea33213e-ba24-4c73-af84-0702c32a88be"},"outputs":[{"data":{"application/vnd.google.colaboratory.intrinsic+json":{"type":"dataframe","variable_name":"df_pro"},"text/html":["\n","  <div id=\"df-5d6b4f8e-a1af-4e68-a550-d93cd12c51c1\" class=\"colab-df-container\">\n","    <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>_id</th>\n","      <th>_score</th>\n","      <th>sales_count_week</th>\n","      <th>name</th>\n","      <th>price</th>\n","      <th>status_id</th>\n","      <th>status_title</th>\n","      <th>stock</th>\n","      <th>photo_MEDIUM</th>\n","      <th>photo_SMALL</th>\n","      <th>...</th>\n","      <th>vendor_owner_city</th>\n","      <th>vendor_owner_id</th>\n","      <th>isFreeShipping</th>\n","      <th>IsAvailable</th>\n","      <th>IsSaleable</th>\n","      <th>mainAttribute</th>\n","      <th>categoryTitle</th>\n","      <th>published</th>\n","      <th>video_ORIGINAL</th>\n","      <th>promotions</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>9873883</td>\n","      <td>468.75000</td>\n","      <td>14</td>\n","      <td>پسته فندقی خندان امسالی یک کیلویی تضمین کیفیت ...</td>\n","      <td>5170000.0</td>\n","      <td>2976.0</td>\n","      <td>در دسترس</td>\n","      <td>746.0</td>\n","      <td>https://statics.basalam.com/public-17/users/Pe...</td>\n","      <td>https://statics.basalam.com/public-17/users/Pe...</td>\n","      <td>...</td>\n","      <td>قاین</td>\n","      <td>13052433.0</td>\n","      <td>False</td>\n","      <td>True</td>\n","      <td>True</td>\n","      <td>1000 گرم</td>\n","      <td>میوه تازه</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>21808</td>\n","      <td>466.66666</td>\n","      <td>13</td>\n","      <td>روغن زیتون فدک 1 لیتری مزرعه ارگانیک فدک سید ا...</td>\n","      <td>6600000.0</td>\n","      <td>2976.0</td>\n","      <td>در دسترس</td>\n","      <td>4.0</td>\n","      <td>https://statics.basalam.com/public-3/users/J2/...</td>\n","      <td>https://statics.basalam.com/public-3/users/J2/...</td>\n","      <td>...</td>\n","      <td>قم</td>\n","      <td>20.0</td>\n","      <td>False</td>\n","      <td>True</td>\n","      <td>True</td>\n","      <td>900 گرم</td>\n","      <td>روغن‌های خوراکی</td>\n","      <td>True</td>\n","      <td>https://basalam-com.arvanvod.ir/yOpvGE3e0D/x3Q...</td>\n","      <td>NaN</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>10215970</td>\n","      <td>464.28570</td>\n","      <td>12</td>\n","      <td>عناب درجه یک  بیرجند یک کیلویی. تضمین کیفیت و ...</td>\n","      <td>1360000.0</td>\n","      <td>2976.0</td>\n","      <td>در دسترس</td>\n","      <td>813.0</td>\n","      <td>https://statics.basalam.com/public-13/users/Pe...</td>\n","      <td>https://statics.basalam.com/public-13/users/Pe...</td>\n","      <td>...</td>\n","      <td>قاین</td>\n","      <td>13052433.0</td>\n","      <td>False</td>\n","      <td>True</td>\n","      <td>True</td>\n","      <td>1000 گرم</td>\n","      <td>میوه تازه</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>11061637</td>\n","      <td>461.53845</td>\n","      <td>11</td>\n","      <td>هل سبز اکبر بنفش50گرمی.  سبز ودرشت وبسیار معطر</td>\n","      <td>1054000.0</td>\n","      <td>2976.0</td>\n","      <td>در دسترس</td>\n","      <td>1708.0</td>\n","      <td>https://statics.basalam.com/public-14/users/ME...</td>\n","      <td>https://statics.basalam.com/public-14/users/ME...</td>\n","      <td>...</td>\n","      <td>قاین</td>\n","      <td>1145924.0</td>\n","      <td>False</td>\n","      <td>True</td>\n","      <td>True</td>\n","      <td>50 گرم</td>\n","      <td>ادویه</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>10843522</td>\n","      <td>461.53845</td>\n","      <td>11</td>\n","      <td>زرشک دانه اناری اعلا 1402(یک کیلویی).محصول تضم...</td>\n","      <td>1830000.0</td>\n","      <td>2976.0</td>\n","      <td>در دسترس</td>\n","      <td>1509.0</td>\n","      <td>https://statics.basalam.com/public-16/users/LZ...</td>\n","      <td>https://statics.basalam.com/public-16/users/LZ...</td>\n","      <td>...</td>\n","      <td>قاین</td>\n","      <td>1246369.0</td>\n","      <td>False</td>\n","      <td>True</td>\n","      <td>True</td>\n","      <td>1000 گرم</td>\n","      <td>میوه تازه</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","    </tr>\n","  </tbody>\n","</table>\n","<p>5 rows × 43 columns</p>\n","</div>\n","    <div class=\"colab-df-buttons\">\n","\n","  <div class=\"colab-df-container\">\n","    <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-5d6b4f8e-a1af-4e68-a550-d93cd12c51c1')\"\n","            title=\"Convert this dataframe to an interactive table.\"\n","            style=\"display:none;\">\n","\n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\" viewBox=\"0 -960 960 960\">\n","    <path d=\"M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z\"/>\n","  </svg>\n","    </button>\n","\n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    .colab-df-buttons div {\n","      margin-bottom: 4px;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","    <script>\n","      const buttonEl =\n","        document.querySelector('#df-5d6b4f8e-a1af-4e68-a550-d93cd12c51c1 button.colab-df-convert');\n","      buttonEl.style.display =\n","        google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","      async function convertToInteractive(key) {\n","        const element = document.querySelector('#df-5d6b4f8e-a1af-4e68-a550-d93cd12c51c1');\n","        const dataTable =\n","          await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                    [key], {});\n","        if (!dataTable) return;\n","\n","        const docLinkHtml = 'Like what you see? Visit the ' +\n","          '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","          + ' to learn more about interactive tables.';\n","        element.innerHTML = '';\n","        dataTable['output_type'] = 'display_data';\n","        await google.colab.output.renderOutput(dataTable, element);\n","        const docLink = document.createElement('div');\n","        docLink.innerHTML = docLinkHtml;\n","        element.appendChild(docLink);\n","      }\n","    </script>\n","  </div>\n","\n","\n","<div id=\"df-8900bfab-f724-4b1d-af90-3a00468ec9b8\">\n","  <button class=\"colab-df-quickchart\" onclick=\"quickchart('df-8900bfab-f724-4b1d-af90-3a00468ec9b8')\"\n","            title=\"Suggest charts\"\n","            style=\"display:none;\">\n","\n","<svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","     width=\"24px\">\n","    <g>\n","        <path d=\"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z\"/>\n","    </g>\n","</svg>\n","  </button>\n","\n","<style>\n","  .colab-df-quickchart {\n","      --bg-color: #E8F0FE;\n","      --fill-color: #1967D2;\n","      --hover-bg-color: #E2EBFA;\n","      --hover-fill-color: #174EA6;\n","      --disabled-fill-color: #AAA;\n","      --disabled-bg-color: #DDD;\n","  }\n","\n","  [theme=dark] .colab-df-quickchart {\n","      --bg-color: #3B4455;\n","      --fill-color: #D2E3FC;\n","      --hover-bg-color: #434B5C;\n","      --hover-fill-color: #FFFFFF;\n","      --disabled-bg-color: #3B4455;\n","      --disabled-fill-color: #666;\n","  }\n","\n","  .colab-df-quickchart {\n","    background-color: var(--bg-color);\n","    border: none;\n","    border-radius: 50%;\n","    cursor: pointer;\n","    display: none;\n","    fill: var(--fill-color);\n","    height: 32px;\n","    padding: 0;\n","    width: 32px;\n","  }\n","\n","  .colab-df-quickchart:hover {\n","    background-color: var(--hover-bg-color);\n","    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);\n","    fill: var(--button-hover-fill-color);\n","  }\n","\n","  .colab-df-quickchart-complete:disabled,\n","  .colab-df-quickchart-complete:disabled:hover {\n","    background-color: var(--disabled-bg-color);\n","    fill: var(--disabled-fill-color);\n","    box-shadow: none;\n","  }\n","\n","  .colab-df-spinner {\n","    border: 2px solid var(--fill-color);\n","    border-color: transparent;\n","    border-bottom-color: var(--fill-color);\n","    animation:\n","      spin 1s steps(1) infinite;\n","  }\n","\n","  @keyframes spin {\n","    0% {\n","      border-color: transparent;\n","      border-bottom-color: var(--fill-color);\n","      border-left-color: var(--fill-color);\n","    }\n","    20% {\n","      border-color: transparent;\n","      border-left-color: var(--fill-color);\n","      border-top-color: var(--fill-color);\n","    }\n","    30% {\n","      border-color: transparent;\n","      border-left-color: var(--fill-color);\n","      border-top-color: var(--fill-color);\n","      border-right-color: var(--fill-color);\n","    }\n","    40% {\n","      border-color: transparent;\n","      border-right-color: var(--fill-color);\n","      border-top-color: var(--fill-color);\n","    }\n","    60% {\n","      border-color: transparent;\n","      border-right-color: var(--fill-color);\n","    }\n","    80% {\n","      border-color: transparent;\n","      border-right-color: var(--fill-color);\n","      border-bottom-color: var(--fill-color);\n","    }\n","    90% {\n","      border-color: transparent;\n","      border-bottom-color: var(--fill-color);\n","    }\n","  }\n","</style>\n","\n","  <script>\n","    async function quickchart(key) {\n","      const quickchartButtonEl =\n","        document.querySelector('#' + key + ' button');\n","      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.\n","      quickchartButtonEl.classList.add('colab-df-spinner');\n","      try {\n","        const charts = await google.colab.kernel.invokeFunction(\n","            'suggestCharts', [key], {});\n","      } catch (error) {\n","        console.error('Error during call to suggestCharts:', error);\n","      }\n","      quickchartButtonEl.classList.remove('colab-df-spinner');\n","      quickchartButtonEl.classList.add('colab-df-quickchart-complete');\n","    }\n","    (() => {\n","      let quickchartButtonEl =\n","        document.querySelector('#df-8900bfab-f724-4b1d-af90-3a00468ec9b8 button');\n","      quickchartButtonEl.style.display =\n","        google.colab.kernel.accessAllowed ? 'block' : 'none';\n","    })();\n","  </script>\n","</div>\n","\n","    </div>\n","  </div>\n"],"text/plain":["        _id     _score  sales_count_week  \\\n","0   9873883  468.75000                14   \n","1     21808  466.66666                13   \n","2  10215970  464.28570                12   \n","3  11061637  461.53845                11   \n","4  10843522  461.53845                11   \n","\n","                                                name      price  status_id  \\\n","0  پسته فندقی خندان امسالی یک کیلویی تضمین کیفیت ...  5170000.0     2976.0   \n","1  روغن زیتون فدک 1 لیتری مزرعه ارگانیک فدک سید ا...  6600000.0     2976.0   \n","2  عناب درجه یک  بیرجند یک کیلویی. تضمین کیفیت و ...  1360000.0     2976.0   \n","3     هل سبز اکبر بنفش50گرمی.  سبز ودرشت وبسیار معطر  1054000.0     2976.0   \n","4  زرشک دانه اناری اعلا 1402(یک کیلویی).محصول تضم...  1830000.0     2976.0   \n","\n","  status_title   stock                                       photo_MEDIUM  \\\n","0     در دسترس   746.0  https://statics.basalam.com/public-17/users/Pe...   \n","1     در دسترس     4.0  https://statics.basalam.com/public-3/users/J2/...   \n","2     در دسترس   813.0  https://statics.basalam.com/public-13/users/Pe...   \n","3     در دسترس  1708.0  https://statics.basalam.com/public-14/users/ME...   \n","4     در دسترس  1509.0  https://statics.basalam.com/public-16/users/LZ...   \n","\n","                                         photo_SMALL  ...  vendor_owner_city  \\\n","0  https://statics.basalam.com/public-17/users/Pe...  ...               قاین   \n","1  https://statics.basalam.com/public-3/users/J2/...  ...                 قم   \n","2  https://statics.basalam.com/public-13/users/Pe...  ...               قاین   \n","3  https://statics.basalam.com/public-14/users/ME...  ...               قاین   \n","4  https://statics.basalam.com/public-16/users/LZ...  ...               قاین   \n","\n","   vendor_owner_id  isFreeShipping  IsAvailable  IsSaleable  mainAttribute  \\\n","0       13052433.0           False         True        True       1000 گرم   \n","1             20.0           False         True        True        900 گرم   \n","2       13052433.0           False         True        True       1000 گرم   \n","3        1145924.0           False         True        True         50 گرم   \n","4        1246369.0           False         True        True       1000 گرم   \n","\n","     categoryTitle published  \\\n","0        میوه تازه       NaN   \n","1  روغن‌های خوراکی      True   \n","2        میوه تازه       NaN   \n","3            ادویه       NaN   \n","4        میوه تازه       NaN   \n","\n","                                      video_ORIGINAL  promotions  \n","0                                                NaN         NaN  \n","1  https://basalam-com.arvanvod.ir/yOpvGE3e0D/x3Q...         NaN  \n","2                                                NaN         NaN  \n","3                                                NaN         NaN  \n","4                                                NaN         NaN  \n","\n","[5 rows x 43 columns]"]},"execution_count":4,"metadata":{},"output_type":"execute_result"}],"source":["df_pro.head()"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":2772,"status":"ok","timestamp":1731664453402,"user":{"displayName":"Hoda Nayebi","userId":"08056384129491287285"},"user_tz":480},"id":"WrhOAxhVPJBC","outputId":"92ae6ce7-8ca1-463c-baa1-d65f334aac87"},"outputs":[{"name":"stdout","output_type":"stream","text":["_id 0\n","_score 0\n","sales_count_week 0\n","name 8\n","price 2\n","status_id 2\n","status_title 2585\n","stock 2\n","photo_MEDIUM 540\n","photo_SMALL 540\n","rating_average 3\n","rating_count 3\n","rating_signals 3\n","primaryPrice 3\n","preparationDays 3\n","weight 3\n","categoryId 146163\n","has_delivery 146166\n","has_variation 3\n","new_categoryId 3\n","navigation_id 2363132\n","vendor_name 3\n","vendor_identifier 3\n","vendor_statusId 3\n","vendor_freeShippingToIran 669330\n","vendor_freeShippingToSameCity 786896\n","vendor_cityId 3\n","vendor_provinceId 3\n","vendor_has_delivery 10409\n","vendor_score 1239540\n","vendor_id 3\n","vendor_status_id 3\n","vendor_status_title 3\n","vendor_owner_city 7\n","vendor_owner_id 3\n","isFreeShipping 3\n","IsAvailable 3\n","IsSaleable 3\n","mainAttribute 2213550\n","categoryTitle 46\n","published 2341306\n","video_ORIGINAL 2254969\n","promotions 2411289\n"]}],"source":["for col in df_pro.columns:\n","  print(col , df_pro[col].isnull().sum())"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"UONKzt_TPjwp"},"outputs":[],"source":["df_pro = df_pro[['_id','categoryTitle','_score','rating_average','rating_count','primaryPrice','price','preparationDays','weight','vendor_has_delivery','isFreeShipping','vendor_score']]"]},{"cell_type":"code","execution_count":null,"metadata":{"cellView":"form","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":1894,"status":"ok","timestamp":1731665897825,"user":{"displayName":"Hoda Nayebi","userId":"08056384129491287285"},"user_tz":480},"id":"eoVyOsusQ00H","outputId":"6ba25911-d1a8-4bda-c4fa-2a87f0551775"},"outputs":[{"name":"stdout","output_type":"stream","text":[" duplicates: 0  null values: 0\n"]}],"source":["# @title Preprocess df_products\n","\n","df_pro = df_pro.drop_duplicates()\n","df_pro = df_pro.dropna()\n","df_pro['Discount'] = df_pro['primaryPrice'] - df_pro['price']\n","print(f' duplicates: {df_pro.duplicated().sum()}  null values: {df_pro.isnull().sum().sum()}')"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"hNTKC2rbVbwA","colab":{"base_uri":"https://localhost:8080/","height":342},"executionInfo":{"status":"ok","timestamp":1732012126159,"user_tz":-210,"elapsed":5767,"user":{"displayName":"Hoda Nayebi","userId":"08056384129491287285"}},"outputId":"9197d799-f80d-4c7c-f5be-32a87bd4e863"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["                      _id_x  productId  star   user_id  isPost  isPublic  \\\n","0  661ba7096a6e1c5d7e653541     824662     5  15127771   False      True   \n","1  661ba7096a6e1c5d7e653542     824662     5   2695119   False      True   \n","2  661ba7096a6e1c5d7e653543     824662     5  11408497   False      True   \n","3  661ba7096a6e1c5d7e653544     824662     5    482919   False      True   \n","4  661ba7096a6e1c5d7e653545     824662     5   4427128   False      True   \n","\n","             createdAt  isLikedByCurrentUser  likeCount  dislikeCount  ...  \\\n","0  2024-04-03T23:45:57                 False          0             0  ...   \n","1  2024-04-03T22:49:50                 False          0             0  ...   \n","2  2024-04-03T22:19:06                 False          0             0  ...   \n","3  2024-04-03T19:49:25                 False          0             0  ...   \n","4  2024-04-03T15:50:37                 False          0             0  ...   \n","\n","     _score  rating_average rating_count  primaryPrice      price  \\\n","0  488.3721             4.8       2957.0     2300000.0  1569000.0   \n","1  488.3721             4.8       2957.0     2300000.0  1569000.0   \n","2  488.3721             4.8       2957.0     2300000.0  1569000.0   \n","3  488.3721             4.8       2957.0     2300000.0  1569000.0   \n","4  488.3721             4.8       2957.0     2300000.0  1569000.0   \n","\n","   preparationDays  weight  vendor_has_delivery  isFreeShipping  vendor_score  \n","0              2.0  1000.0                 True           False           1.0  \n","1              2.0  1000.0                 True           False           1.0  \n","2              2.0  1000.0                 True           False           1.0  \n","3              2.0  1000.0                 True           False           1.0  \n","4              2.0  1000.0                 True           False           1.0  \n","\n","[5 rows x 25 columns]"],"text/html":["\n","  <div id=\"df-78596aa8-b9ce-4a39-b8fe-d9dfd2cc2f78\" class=\"colab-df-container\">\n","    <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>_id_x</th>\n","      <th>productId</th>\n","      <th>star</th>\n","      <th>user_id</th>\n","      <th>isPost</th>\n","      <th>isPublic</th>\n","      <th>createdAt</th>\n","      <th>isLikedByCurrentUser</th>\n","      <th>likeCount</th>\n","      <th>dislikeCount</th>\n","      <th>...</th>\n","      <th>_score</th>\n","      <th>rating_average</th>\n","      <th>rating_count</th>\n","      <th>primaryPrice</th>\n","      <th>price</th>\n","      <th>preparationDays</th>\n","      <th>weight</th>\n","      <th>vendor_has_delivery</th>\n","      <th>isFreeShipping</th>\n","      <th>vendor_score</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>661ba7096a6e1c5d7e653541</td>\n","      <td>824662</td>\n","      <td>5</td>\n","      <td>15127771</td>\n","      <td>False</td>\n","      <td>True</td>\n","      <td>2024-04-03T23:45:57</td>\n","      <td>False</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>...</td>\n","      <td>488.3721</td>\n","      <td>4.8</td>\n","      <td>2957.0</td>\n","      <td>2300000.0</td>\n","      <td>1569000.0</td>\n","      <td>2.0</td>\n","      <td>1000.0</td>\n","      <td>True</td>\n","      <td>False</td>\n","      <td>1.0</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>661ba7096a6e1c5d7e653542</td>\n","      <td>824662</td>\n","      <td>5</td>\n","      <td>2695119</td>\n","      <td>False</td>\n","      <td>True</td>\n","      <td>2024-04-03T22:49:50</td>\n","      <td>False</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>...</td>\n","      <td>488.3721</td>\n","      <td>4.8</td>\n","      <td>2957.0</td>\n","      <td>2300000.0</td>\n","      <td>1569000.0</td>\n","      <td>2.0</td>\n","      <td>1000.0</td>\n","      <td>True</td>\n","      <td>False</td>\n","      <td>1.0</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>661ba7096a6e1c5d7e653543</td>\n","      <td>824662</td>\n","      <td>5</td>\n","      <td>11408497</td>\n","      <td>False</td>\n","      <td>True</td>\n","      <td>2024-04-03T22:19:06</td>\n","      <td>False</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>...</td>\n","      <td>488.3721</td>\n","      <td>4.8</td>\n","      <td>2957.0</td>\n","      <td>2300000.0</td>\n","      <td>1569000.0</td>\n","      <td>2.0</td>\n","      <td>1000.0</td>\n","      <td>True</td>\n","      <td>False</td>\n","      <td>1.0</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>661ba7096a6e1c5d7e653544</td>\n","      <td>824662</td>\n","      <td>5</td>\n","      <td>482919</td>\n","      <td>False</td>\n","      <td>True</td>\n","      <td>2024-04-03T19:49:25</td>\n","      <td>False</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>...</td>\n","      <td>488.3721</td>\n","      <td>4.8</td>\n","      <td>2957.0</td>\n","      <td>2300000.0</td>\n","      <td>1569000.0</td>\n","      <td>2.0</td>\n","      <td>1000.0</td>\n","      <td>True</td>\n","      <td>False</td>\n","      <td>1.0</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>661ba7096a6e1c5d7e653545</td>\n","      <td>824662</td>\n","      <td>5</td>\n","      <td>4427128</td>\n","      <td>False</td>\n","      <td>True</td>\n","      <td>2024-04-03T15:50:37</td>\n","      <td>False</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>...</td>\n","      <td>488.3721</td>\n","      <td>4.8</td>\n","      <td>2957.0</td>\n","      <td>2300000.0</td>\n","      <td>1569000.0</td>\n","      <td>2.0</td>\n","      <td>1000.0</td>\n","      <td>True</td>\n","      <td>False</td>\n","      <td>1.0</td>\n","    </tr>\n","  </tbody>\n","</table>\n","<p>5 rows × 25 columns</p>\n","</div>\n","    <div class=\"colab-df-buttons\">\n","\n","  <div class=\"colab-df-container\">\n","    <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-78596aa8-b9ce-4a39-b8fe-d9dfd2cc2f78')\"\n","            title=\"Convert this dataframe to an interactive table.\"\n","            style=\"display:none;\">\n","\n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\" viewBox=\"0 -960 960 960\">\n","    <path d=\"M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z\"/>\n","  </svg>\n","    </button>\n","\n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    .colab-df-buttons div {\n","      margin-bottom: 4px;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","    <script>\n","      const buttonEl =\n","        document.querySelector('#df-78596aa8-b9ce-4a39-b8fe-d9dfd2cc2f78 button.colab-df-convert');\n","      buttonEl.style.display =\n","        google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","      async function convertToInteractive(key) {\n","        const element = document.querySelector('#df-78596aa8-b9ce-4a39-b8fe-d9dfd2cc2f78');\n","        const dataTable =\n","          await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                    [key], {});\n","        if (!dataTable) return;\n","\n","        const docLinkHtml = 'Like what you see? Visit the ' +\n","          '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","          + ' to learn more about interactive tables.';\n","        element.innerHTML = '';\n","        dataTable['output_type'] = 'display_data';\n","        await google.colab.output.renderOutput(dataTable, element);\n","        const docLink = document.createElement('div');\n","        docLink.innerHTML = docLinkHtml;\n","        element.appendChild(docLink);\n","      }\n","    </script>\n","  </div>\n","\n","\n","<div id=\"df-bc2eeefa-3f39-4bc5-9ec2-125cc9b9e27e\">\n","  <button class=\"colab-df-quickchart\" onclick=\"quickchart('df-bc2eeefa-3f39-4bc5-9ec2-125cc9b9e27e')\"\n","            title=\"Suggest charts\"\n","            style=\"display:none;\">\n","\n","<svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","     width=\"24px\">\n","    <g>\n","        <path d=\"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z\"/>\n","    </g>\n","</svg>\n","  </button>\n","\n","<style>\n","  .colab-df-quickchart {\n","      --bg-color: #E8F0FE;\n","      --fill-color: #1967D2;\n","      --hover-bg-color: #E2EBFA;\n","      --hover-fill-color: #174EA6;\n","      --disabled-fill-color: #AAA;\n","      --disabled-bg-color: #DDD;\n","  }\n","\n","  [theme=dark] .colab-df-quickchart {\n","      --bg-color: #3B4455;\n","      --fill-color: #D2E3FC;\n","      --hover-bg-color: #434B5C;\n","      --hover-fill-color: #FFFFFF;\n","      --disabled-bg-color: #3B4455;\n","      --disabled-fill-color: #666;\n","  }\n","\n","  .colab-df-quickchart {\n","    background-color: var(--bg-color);\n","    border: none;\n","    border-radius: 50%;\n","    cursor: pointer;\n","    display: none;\n","    fill: var(--fill-color);\n","    height: 32px;\n","    padding: 0;\n","    width: 32px;\n","  }\n","\n","  .colab-df-quickchart:hover {\n","    background-color: var(--hover-bg-color);\n","    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);\n","    fill: var(--button-hover-fill-color);\n","  }\n","\n","  .colab-df-quickchart-complete:disabled,\n","  .colab-df-quickchart-complete:disabled:hover {\n","    background-color: var(--disabled-bg-color);\n","    fill: var(--disabled-fill-color);\n","    box-shadow: none;\n","  }\n","\n","  .colab-df-spinner {\n","    border: 2px solid var(--fill-color);\n","    border-color: transparent;\n","    border-bottom-color: var(--fill-color);\n","    animation:\n","      spin 1s steps(1) infinite;\n","  }\n","\n","  @keyframes spin {\n","    0% {\n","      border-color: transparent;\n","      border-bottom-color: var(--fill-color);\n","      border-left-color: var(--fill-color);\n","    }\n","    20% {\n","      border-color: transparent;\n","      border-left-color: var(--fill-color);\n","      border-top-color: var(--fill-color);\n","    }\n","    30% {\n","      border-color: transparent;\n","      border-left-color: var(--fill-color);\n","      border-top-color: var(--fill-color);\n","      border-right-color: var(--fill-color);\n","    }\n","    40% {\n","      border-color: transparent;\n","      border-right-color: var(--fill-color);\n","      border-top-color: var(--fill-color);\n","    }\n","    60% {\n","      border-color: transparent;\n","      border-right-color: var(--fill-color);\n","    }\n","    80% {\n","      border-color: transparent;\n","      border-right-color: var(--fill-color);\n","      border-bottom-color: var(--fill-color);\n","    }\n","    90% {\n","      border-color: transparent;\n","      border-bottom-color: var(--fill-color);\n","    }\n","  }\n","</style>\n","\n","  <script>\n","    async function quickchart(key) {\n","      const quickchartButtonEl =\n","        document.querySelector('#' + key + ' button');\n","      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.\n","      quickchartButtonEl.classList.add('colab-df-spinner');\n","      try {\n","        const charts = await google.colab.kernel.invokeFunction(\n","            'suggestCharts', [key], {});\n","      } catch (error) {\n","        console.error('Error during call to suggestCharts:', error);\n","      }\n","      quickchartButtonEl.classList.remove('colab-df-spinner');\n","      quickchartButtonEl.classList.add('colab-df-quickchart-complete');\n","    }\n","    (() => {\n","      let quickchartButtonEl =\n","        document.querySelector('#df-bc2eeefa-3f39-4bc5-9ec2-125cc9b9e27e button');\n","      quickchartButtonEl.style.display =\n","        google.colab.kernel.accessAllowed ? 'block' : 'none';\n","    })();\n","  </script>\n","</div>\n","    </div>\n","  </div>\n"],"application/vnd.google.colaboratory.intrinsic+json":{"type":"dataframe","variable_name":"df_merged"}},"metadata":{},"execution_count":6}],"source":["# @title Merging both datasets\n","\n","df_merged = pd.merge(df, df_pro, left_on='productId', right_on='_id', how='left')\n","df_merged.head()"]},{"cell_type":"code","source":["df_merged.columns"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"Xwvcd0zh99JE","executionInfo":{"status":"ok","timestamp":1732012148974,"user_tz":-210,"elapsed":623,"user":{"displayName":"Hoda Nayebi","userId":"08056384129491287285"}},"outputId":"d8615102-3d8e-4951-c2c6-ba5c53528ec2"},"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["Index(['_id_x', 'productId', 'star', 'user_id', 'isPost', 'isPublic',\n","       'createdAt', 'isLikedByCurrentUser', 'likeCount', 'dislikeCount',\n","       'attachments', 'history_count', 'description', '_id_y', 'categoryTitle',\n","       '_score', 'rating_average', 'rating_count', 'primaryPrice', 'price',\n","       'preparationDays', 'weight', 'vendor_has_delivery', 'isFreeShipping',\n","       'vendor_score'],\n","      dtype='object')"]},"metadata":{},"execution_count":7}]},{"cell_type":"code","execution_count":null,"metadata":{"id":"A3OKhl45WGdQ"},"outputs":[],"source":["# @title importing saved dataset\n","\n","df = pd.read_csv('/content/drive/MyDrive/Basalam.csv')"]},{"cell_type":"code","source":["df_merged = df_merged.dropna()"],"metadata":{"id":"BOoiYlrz_CTf"},"execution_count":null,"outputs":[]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":833},"executionInfo":{"elapsed":2521,"status":"ok","timestamp":1732012454707,"user":{"displayName":"Hoda Nayebi","userId":"08056384129491287285"},"user_tz":-210},"id":"21RUyVlDWnKd","outputId":"739eb2ba-b061-4e8a-b798-de6c22a249d8"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["<pandas.io.formats.style.Styler at 0x7db0322d3be0>"],"text/html":["<style type=\"text/css\">\n","#T_1593e_row0_col3, #T_1593e_row1_col3, #T_1593e_row2_col3, #T_1593e_row3_col3, #T_1593e_row4_col3, #T_1593e_row5_col3, #T_1593e_row6_col3, #T_1593e_row7_col3, #T_1593e_row8_col3, #T_1593e_row9_col3, #T_1593e_row10_col3, #T_1593e_row11_col3, #T_1593e_row12_col3, #T_1593e_row13_col3, #T_1593e_row14_col3, #T_1593e_row15_col3, #T_1593e_row16_col3, #T_1593e_row17_col3, #T_1593e_row18_col3, #T_1593e_row19_col3, #T_1593e_row20_col3, #T_1593e_row21_col3, #T_1593e_row22_col3, #T_1593e_row23_col3, #T_1593e_row24_col3 {\n","  background-color: #f0f0f3;\n","  color: #000000;\n","}\n","</style>\n","<table id=\"T_1593e\" class=\"dataframe\">\n","  <thead>\n","    <tr>\n","      <th class=\"blank level0\" >&nbsp;</th>\n","      <th id=\"T_1593e_level0_col0\" class=\"col_heading level0 col0\" >columns</th>\n","      <th id=\"T_1593e_level0_col1\" class=\"col_heading level0 col1\" >Type</th>\n","      <th id=\"T_1593e_level0_col2\" class=\"col_heading level0 col2\" >Total null</th>\n","      <th id=\"T_1593e_level0_col3\" class=\"col_heading level0 col3\" >%</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th id=\"T_1593e_level0_row0\" class=\"row_heading level0 row0\" >0</th>\n","      <td id=\"T_1593e_row0_col0\" class=\"data row0 col0\" >_id_x</td>\n","      <td id=\"T_1593e_row0_col1\" class=\"data row0 col1\" >object</td>\n","      <td id=\"T_1593e_row0_col2\" class=\"data row0 col2\" >0</td>\n","      <td id=\"T_1593e_row0_col3\" class=\"data row0 col3\" >0.00</td>\n","    </tr>\n","    <tr>\n","      <th id=\"T_1593e_level0_row1\" class=\"row_heading level0 row1\" >1</th>\n","      <td id=\"T_1593e_row1_col0\" class=\"data row1 col0\" >productId</td>\n","      <td id=\"T_1593e_row1_col1\" class=\"data row1 col1\" >int64</td>\n","      <td id=\"T_1593e_row1_col2\" class=\"data row1 col2\" >0</td>\n","      <td id=\"T_1593e_row1_col3\" class=\"data row1 col3\" >0.00</td>\n","    </tr>\n","    <tr>\n","      <th id=\"T_1593e_level0_row2\" class=\"row_heading level0 row2\" >2</th>\n","      <td id=\"T_1593e_row2_col0\" class=\"data row2 col0\" >star</td>\n","      <td id=\"T_1593e_row2_col1\" class=\"data row2 col1\" >int64</td>\n","      <td id=\"T_1593e_row2_col2\" class=\"data row2 col2\" >0</td>\n","      <td id=\"T_1593e_row2_col3\" class=\"data row2 col3\" >0.00</td>\n","    </tr>\n","    <tr>\n","      <th id=\"T_1593e_level0_row3\" class=\"row_heading level0 row3\" >3</th>\n","      <td id=\"T_1593e_row3_col0\" class=\"data row3 col0\" >user_id</td>\n","      <td id=\"T_1593e_row3_col1\" class=\"data row3 col1\" >int64</td>\n","      <td id=\"T_1593e_row3_col2\" class=\"data row3 col2\" >0</td>\n","      <td id=\"T_1593e_row3_col3\" class=\"data row3 col3\" >0.00</td>\n","    </tr>\n","    <tr>\n","      <th id=\"T_1593e_level0_row4\" class=\"row_heading level0 row4\" >4</th>\n","      <td id=\"T_1593e_row4_col0\" class=\"data row4 col0\" >isPost</td>\n","      <td id=\"T_1593e_row4_col1\" class=\"data row4 col1\" >bool</td>\n","      <td id=\"T_1593e_row4_col2\" class=\"data row4 col2\" >0</td>\n","      <td id=\"T_1593e_row4_col3\" class=\"data row4 col3\" >0.00</td>\n","    </tr>\n","    <tr>\n","      <th id=\"T_1593e_level0_row5\" class=\"row_heading level0 row5\" >5</th>\n","      <td id=\"T_1593e_row5_col0\" class=\"data row5 col0\" >isPublic</td>\n","      <td id=\"T_1593e_row5_col1\" class=\"data row5 col1\" >bool</td>\n","      <td id=\"T_1593e_row5_col2\" class=\"data row5 col2\" >0</td>\n","      <td id=\"T_1593e_row5_col3\" class=\"data row5 col3\" >0.00</td>\n","    </tr>\n","    <tr>\n","      <th id=\"T_1593e_level0_row6\" class=\"row_heading level0 row6\" >6</th>\n","      <td id=\"T_1593e_row6_col0\" class=\"data row6 col0\" >createdAt</td>\n","      <td id=\"T_1593e_row6_col1\" class=\"data row6 col1\" >object</td>\n","      <td id=\"T_1593e_row6_col2\" class=\"data row6 col2\" >0</td>\n","      <td id=\"T_1593e_row6_col3\" class=\"data row6 col3\" >0.00</td>\n","    </tr>\n","    <tr>\n","      <th id=\"T_1593e_level0_row7\" class=\"row_heading level0 row7\" >7</th>\n","      <td id=\"T_1593e_row7_col0\" class=\"data row7 col0\" >isLikedByCurrentUser</td>\n","      <td id=\"T_1593e_row7_col1\" class=\"data row7 col1\" >bool</td>\n","      <td id=\"T_1593e_row7_col2\" class=\"data row7 col2\" >0</td>\n","      <td id=\"T_1593e_row7_col3\" class=\"data row7 col3\" >0.00</td>\n","    </tr>\n","    <tr>\n","      <th id=\"T_1593e_level0_row8\" class=\"row_heading level0 row8\" >8</th>\n","      <td id=\"T_1593e_row8_col0\" class=\"data row8 col0\" >likeCount</td>\n","      <td id=\"T_1593e_row8_col1\" class=\"data row8 col1\" >int64</td>\n","      <td id=\"T_1593e_row8_col2\" class=\"data row8 col2\" >0</td>\n","      <td id=\"T_1593e_row8_col3\" class=\"data row8 col3\" >0.00</td>\n","    </tr>\n","    <tr>\n","      <th id=\"T_1593e_level0_row9\" class=\"row_heading level0 row9\" >9</th>\n","      <td id=\"T_1593e_row9_col0\" class=\"data row9 col0\" >dislikeCount</td>\n","      <td id=\"T_1593e_row9_col1\" class=\"data row9 col1\" >int64</td>\n","      <td id=\"T_1593e_row9_col2\" class=\"data row9 col2\" >0</td>\n","      <td id=\"T_1593e_row9_col3\" class=\"data row9 col3\" >0.00</td>\n","    </tr>\n","    <tr>\n","      <th id=\"T_1593e_level0_row10\" class=\"row_heading level0 row10\" >10</th>\n","      <td id=\"T_1593e_row10_col0\" class=\"data row10 col0\" >attachments</td>\n","      <td id=\"T_1593e_row10_col1\" class=\"data row10 col1\" >object</td>\n","      <td id=\"T_1593e_row10_col2\" class=\"data row10 col2\" >0</td>\n","      <td id=\"T_1593e_row10_col3\" class=\"data row10 col3\" >0.00</td>\n","    </tr>\n","    <tr>\n","      <th id=\"T_1593e_level0_row11\" class=\"row_heading level0 row11\" >11</th>\n","      <td id=\"T_1593e_row11_col0\" class=\"data row11 col0\" >history_count</td>\n","      <td id=\"T_1593e_row11_col1\" class=\"data row11 col1\" >int64</td>\n","      <td id=\"T_1593e_row11_col2\" class=\"data row11 col2\" >0</td>\n","      <td id=\"T_1593e_row11_col3\" class=\"data row11 col3\" >0.00</td>\n","    </tr>\n","    <tr>\n","      <th id=\"T_1593e_level0_row12\" class=\"row_heading level0 row12\" >12</th>\n","      <td id=\"T_1593e_row12_col0\" class=\"data row12 col0\" >description</td>\n","      <td id=\"T_1593e_row12_col1\" class=\"data row12 col1\" >object</td>\n","      <td id=\"T_1593e_row12_col2\" class=\"data row12 col2\" >0</td>\n","      <td id=\"T_1593e_row12_col3\" class=\"data row12 col3\" >0.00</td>\n","    </tr>\n","    <tr>\n","      <th id=\"T_1593e_level0_row13\" class=\"row_heading level0 row13\" >13</th>\n","      <td id=\"T_1593e_row13_col0\" class=\"data row13 col0\" >_id_y</td>\n","      <td id=\"T_1593e_row13_col1\" class=\"data row13 col1\" >int64</td>\n","      <td id=\"T_1593e_row13_col2\" class=\"data row13 col2\" >0</td>\n","      <td id=\"T_1593e_row13_col3\" class=\"data row13 col3\" >0.00</td>\n","    </tr>\n","    <tr>\n","      <th id=\"T_1593e_level0_row14\" class=\"row_heading level0 row14\" >14</th>\n","      <td id=\"T_1593e_row14_col0\" class=\"data row14 col0\" >categoryTitle</td>\n","      <td id=\"T_1593e_row14_col1\" class=\"data row14 col1\" >object</td>\n","      <td id=\"T_1593e_row14_col2\" class=\"data row14 col2\" >0</td>\n","      <td id=\"T_1593e_row14_col3\" class=\"data row14 col3\" >0.00</td>\n","    </tr>\n","    <tr>\n","      <th id=\"T_1593e_level0_row15\" class=\"row_heading level0 row15\" >15</th>\n","      <td id=\"T_1593e_row15_col0\" class=\"data row15 col0\" >_score</td>\n","      <td id=\"T_1593e_row15_col1\" class=\"data row15 col1\" >float64</td>\n","      <td id=\"T_1593e_row15_col2\" class=\"data row15 col2\" >0</td>\n","      <td id=\"T_1593e_row15_col3\" class=\"data row15 col3\" >0.00</td>\n","    </tr>\n","    <tr>\n","      <th id=\"T_1593e_level0_row16\" class=\"row_heading level0 row16\" >16</th>\n","      <td id=\"T_1593e_row16_col0\" class=\"data row16 col0\" >rating_average</td>\n","      <td id=\"T_1593e_row16_col1\" class=\"data row16 col1\" >float64</td>\n","      <td id=\"T_1593e_row16_col2\" class=\"data row16 col2\" >0</td>\n","      <td id=\"T_1593e_row16_col3\" class=\"data row16 col3\" >0.00</td>\n","    </tr>\n","    <tr>\n","      <th id=\"T_1593e_level0_row17\" class=\"row_heading level0 row17\" >17</th>\n","      <td id=\"T_1593e_row17_col0\" class=\"data row17 col0\" >rating_count</td>\n","      <td id=\"T_1593e_row17_col1\" class=\"data row17 col1\" >float64</td>\n","      <td id=\"T_1593e_row17_col2\" class=\"data row17 col2\" >0</td>\n","      <td id=\"T_1593e_row17_col3\" class=\"data row17 col3\" >0.00</td>\n","    </tr>\n","    <tr>\n","      <th id=\"T_1593e_level0_row18\" class=\"row_heading level0 row18\" >18</th>\n","      <td id=\"T_1593e_row18_col0\" class=\"data row18 col0\" >primaryPrice</td>\n","      <td id=\"T_1593e_row18_col1\" class=\"data row18 col1\" >float64</td>\n","      <td id=\"T_1593e_row18_col2\" class=\"data row18 col2\" >0</td>\n","      <td id=\"T_1593e_row18_col3\" class=\"data row18 col3\" >0.00</td>\n","    </tr>\n","    <tr>\n","      <th id=\"T_1593e_level0_row19\" class=\"row_heading level0 row19\" >19</th>\n","      <td id=\"T_1593e_row19_col0\" class=\"data row19 col0\" >price</td>\n","      <td id=\"T_1593e_row19_col1\" class=\"data row19 col1\" >float64</td>\n","      <td id=\"T_1593e_row19_col2\" class=\"data row19 col2\" >0</td>\n","      <td id=\"T_1593e_row19_col3\" class=\"data row19 col3\" >0.00</td>\n","    </tr>\n","    <tr>\n","      <th id=\"T_1593e_level0_row20\" class=\"row_heading level0 row20\" >20</th>\n","      <td id=\"T_1593e_row20_col0\" class=\"data row20 col0\" >preparationDays</td>\n","      <td id=\"T_1593e_row20_col1\" class=\"data row20 col1\" >float64</td>\n","      <td id=\"T_1593e_row20_col2\" class=\"data row20 col2\" >0</td>\n","      <td id=\"T_1593e_row20_col3\" class=\"data row20 col3\" >0.00</td>\n","    </tr>\n","    <tr>\n","      <th id=\"T_1593e_level0_row21\" class=\"row_heading level0 row21\" >21</th>\n","      <td id=\"T_1593e_row21_col0\" class=\"data row21 col0\" >weight</td>\n","      <td id=\"T_1593e_row21_col1\" class=\"data row21 col1\" >float64</td>\n","      <td id=\"T_1593e_row21_col2\" class=\"data row21 col2\" >0</td>\n","      <td id=\"T_1593e_row21_col3\" class=\"data row21 col3\" >0.00</td>\n","    </tr>\n","    <tr>\n","      <th id=\"T_1593e_level0_row22\" class=\"row_heading level0 row22\" >22</th>\n","      <td id=\"T_1593e_row22_col0\" class=\"data row22 col0\" >vendor_has_delivery</td>\n","      <td id=\"T_1593e_row22_col1\" class=\"data row22 col1\" >object</td>\n","      <td id=\"T_1593e_row22_col2\" class=\"data row22 col2\" >0</td>\n","      <td id=\"T_1593e_row22_col3\" class=\"data row22 col3\" >0.00</td>\n","    </tr>\n","    <tr>\n","      <th id=\"T_1593e_level0_row23\" class=\"row_heading level0 row23\" >23</th>\n","      <td id=\"T_1593e_row23_col0\" class=\"data row23 col0\" >isFreeShipping</td>\n","      <td id=\"T_1593e_row23_col1\" class=\"data row23 col1\" >object</td>\n","      <td id=\"T_1593e_row23_col2\" class=\"data row23 col2\" >0</td>\n","      <td id=\"T_1593e_row23_col3\" class=\"data row23 col3\" >0.00</td>\n","    </tr>\n","    <tr>\n","      <th id=\"T_1593e_level0_row24\" class=\"row_heading level0 row24\" >24</th>\n","      <td id=\"T_1593e_row24_col0\" class=\"data row24 col0\" >vendor_score</td>\n","      <td id=\"T_1593e_row24_col1\" class=\"data row24 col1\" >float64</td>\n","      <td id=\"T_1593e_row24_col2\" class=\"data row24 col2\" >0</td>\n","      <td id=\"T_1593e_row24_col3\" class=\"data row24 col3\" >0.00</td>\n","    </tr>\n","  </tbody>\n","</table>\n"]},"metadata":{},"execution_count":10}],"source":["# f.dropna(subset=['description'] , inplace=True)\n","\n","percentage_result = df_merged.isnull().sum()/df_merged.shape[0] * 100\n","column_type = [df_merged[col].dtype for col in df_merged.columns]\n","# create a DataFrame to show case the result\n","percentage_result = pd.DataFrame({\"columns\": percentage_result.keys(), \"Type\" : column_type ,\"Total null\" :  df_merged.isnull().sum() ,\"%\": percentage_result.round(2) })\n","percentage_result.reset_index(drop=True, inplace=True)\n","cm = sns.light_palette(\"blue\", as_cmap=True)\n","percentage_result.style.background_gradient(cmap=cm , subset=['%']).format(precision=2)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":643,"status":"ok","timestamp":1732012478173,"user":{"displayName":"Hoda Nayebi","userId":"08056384129491287285"},"user_tz":-210},"id":"FuF9jN8eWonO","outputId":"b136a766-e43e-4fd9-8203-3cf000022c89"},"outputs":[{"output_type":"stream","name":"stdout","text":["<class 'pandas.core.frame.DataFrame'>\n","Index: 1676654 entries, 3 to 3393572\n","Data columns (total 25 columns):\n"," #   Column                Non-Null Count    Dtype  \n","---  ------                --------------    -----  \n"," 0   _id_x                 1676654 non-null  object \n"," 1   productId             1676654 non-null  int64  \n"," 2   star                  1676654 non-null  int64  \n"," 3   user_id               1676654 non-null  int64  \n"," 4   isPost                1676654 non-null  bool   \n"," 5   isPublic              1676654 non-null  bool   \n"," 6   createdAt             1676654 non-null  object \n"," 7   isLikedByCurrentUser  1676654 non-null  bool   \n"," 8   likeCount             1676654 non-null  int64  \n"," 9   dislikeCount          1676654 non-null  int64  \n"," 10  attachments           1676654 non-null  object \n"," 11  history_count         1676654 non-null  int64  \n"," 12  description           1676654 non-null  object \n"," 13  _id_y                 1676654 non-null  int64  \n"," 14  categoryTitle         1676654 non-null  object \n"," 15  _score                1676654 non-null  float64\n"," 16  rating_average        1676654 non-null  float64\n"," 17  rating_count          1676654 non-null  float64\n"," 18  primaryPrice          1676654 non-null  float64\n"," 19  price                 1676654 non-null  float64\n"," 20  preparationDays       1676654 non-null  float64\n"," 21  weight                1676654 non-null  float64\n"," 22  vendor_has_delivery   1676654 non-null  object \n"," 23  isFreeShipping        1676654 non-null  object \n"," 24  vendor_score          1676654 non-null  float64\n","dtypes: bool(3), float64(8), int64(7), object(7)\n","memory usage: 299.0+ MB\n"]}],"source":["df_merged.info()"]},{"cell_type":"code","source":["df_merged.shape"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"VMYOnJGl_Tjc","executionInfo":{"status":"ok","timestamp":1732012506869,"user_tz":-210,"elapsed":8,"user":{"displayName":"Hoda Nayebi","userId":"08056384129491287285"}},"outputId":"1038813d-4ae5-4a33-b1bb-e810f182a073"},"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["(1676654, 25)"]},"metadata":{},"execution_count":13}]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":237},"executionInfo":{"elapsed":379,"status":"ok","timestamp":1731758939949,"user":{"displayName":"Hoda Nayebi","userId":"08056384129491287285"},"user_tz":480},"id":"iLXvN8hS0inc","outputId":"657067a1-f449-40e6-b811-bf37a647719e"},"outputs":[{"data":{"application/vnd.google.colaboratory.intrinsic+json":{"summary":"{\n  \"name\": \"df\",\n  \"rows\": 5,\n  \"fields\": [\n    {\n      \"column\": \"star\",\n      \"properties\": {\n        \"dtype\": \"number\",\n        \"std\": 1,\n        \"min\": 1,\n        \"max\": 5,\n        \"num_unique_values\": 5,\n        \"samples\": [\n          2,\n          5,\n          3\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"count\",\n      \"properties\": {\n        \"dtype\": \"number\",\n        \"std\": 670836,\n        \"min\": 34379,\n        \"max\": 1595399,\n        \"num_unique_values\": 5,\n        \"samples\": [\n          34379,\n          1595399,\n          88340\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"median\",\n      \"properties\": {\n        \"dtype\": \"number\",\n        \"std\": 0.30495901363953803,\n        \"min\": 4.0,\n        \"max\": 4.8,\n        \"num_unique_values\": 5,\n        \"samples\": [\n          4.2,\n          4.8,\n          4.3\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"mean\",\n      \"properties\": {\n        \"dtype\": \"number\",\n        \"std\": 0.4311833155297056,\n        \"min\": 3.5921574267155627,\n        \"max\": 4.69522163421188,\n        \"num_unique_values\": 5,\n        \"samples\": [\n          3.902623694697344,\n          4.69522163421188,\n          4.155665610142631\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    }\n  ]\n}","type":"dataframe"},"text/html":["\n","  <div id=\"df-a5d6430b-29ea-478e-bb7a-351f6e9f206c\" class=\"colab-df-container\">\n","    <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>count</th>\n","      <th>median</th>\n","      <th>mean</th>\n","    </tr>\n","    <tr>\n","      <th>star</th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>1</th>\n","      <td>83442</td>\n","      <td>4.0</td>\n","      <td>3.592157</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>34379</td>\n","      <td>4.2</td>\n","      <td>3.902624</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>88340</td>\n","      <td>4.3</td>\n","      <td>4.155666</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>199778</td>\n","      <td>4.5</td>\n","      <td>4.422135</td>\n","    </tr>\n","    <tr>\n","      <th>5</th>\n","      <td>1595399</td>\n","      <td>4.8</td>\n","      <td>4.695222</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>\n","    <div class=\"colab-df-buttons\">\n","\n","  <div class=\"colab-df-container\">\n","    <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-a5d6430b-29ea-478e-bb7a-351f6e9f206c')\"\n","            title=\"Convert this dataframe to an interactive table.\"\n","            style=\"display:none;\">\n","\n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\" viewBox=\"0 -960 960 960\">\n","    <path d=\"M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z\"/>\n","  </svg>\n","    </button>\n","\n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    .colab-df-buttons div {\n","      margin-bottom: 4px;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","    <script>\n","      const buttonEl =\n","        document.querySelector('#df-a5d6430b-29ea-478e-bb7a-351f6e9f206c button.colab-df-convert');\n","      buttonEl.style.display =\n","        google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","      async function convertToInteractive(key) {\n","        const element = document.querySelector('#df-a5d6430b-29ea-478e-bb7a-351f6e9f206c');\n","        const dataTable =\n","          await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                    [key], {});\n","        if (!dataTable) return;\n","\n","        const docLinkHtml = 'Like what you see? Visit the ' +\n","          '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","          + ' to learn more about interactive tables.';\n","        element.innerHTML = '';\n","        dataTable['output_type'] = 'display_data';\n","        await google.colab.output.renderOutput(dataTable, element);\n","        const docLink = document.createElement('div');\n","        docLink.innerHTML = docLinkHtml;\n","        element.appendChild(docLink);\n","      }\n","    </script>\n","  </div>\n","\n","\n","<div id=\"df-e6e84ffa-0d9b-4e3e-874a-4bad73ea724d\">\n","  <button class=\"colab-df-quickchart\" onclick=\"quickchart('df-e6e84ffa-0d9b-4e3e-874a-4bad73ea724d')\"\n","            title=\"Suggest charts\"\n","            style=\"display:none;\">\n","\n","<svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","     width=\"24px\">\n","    <g>\n","        <path d=\"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z\"/>\n","    </g>\n","</svg>\n","  </button>\n","\n","<style>\n","  .colab-df-quickchart {\n","      --bg-color: #E8F0FE;\n","      --fill-color: #1967D2;\n","      --hover-bg-color: #E2EBFA;\n","      --hover-fill-color: #174EA6;\n","      --disabled-fill-color: #AAA;\n","      --disabled-bg-color: #DDD;\n","  }\n","\n","  [theme=dark] .colab-df-quickchart {\n","      --bg-color: #3B4455;\n","      --fill-color: #D2E3FC;\n","      --hover-bg-color: #434B5C;\n","      --hover-fill-color: #FFFFFF;\n","      --disabled-bg-color: #3B4455;\n","      --disabled-fill-color: #666;\n","  }\n","\n","  .colab-df-quickchart {\n","    background-color: var(--bg-color);\n","    border: none;\n","    border-radius: 50%;\n","    cursor: pointer;\n","    display: none;\n","    fill: var(--fill-color);\n","    height: 32px;\n","    padding: 0;\n","    width: 32px;\n","  }\n","\n","  .colab-df-quickchart:hover {\n","    background-color: var(--hover-bg-color);\n","    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);\n","    fill: var(--button-hover-fill-color);\n","  }\n","\n","  .colab-df-quickchart-complete:disabled,\n","  .colab-df-quickchart-complete:disabled:hover {\n","    background-color: var(--disabled-bg-color);\n","    fill: var(--disabled-fill-color);\n","    box-shadow: none;\n","  }\n","\n","  .colab-df-spinner {\n","    border: 2px solid var(--fill-color);\n","    border-color: transparent;\n","    border-bottom-color: var(--fill-color);\n","    animation:\n","      spin 1s steps(1) infinite;\n","  }\n","\n","  @keyframes spin {\n","    0% {\n","      border-color: transparent;\n","      border-bottom-color: var(--fill-color);\n","      border-left-color: var(--fill-color);\n","    }\n","    20% {\n","      border-color: transparent;\n","      border-left-color: var(--fill-color);\n","      border-top-color: var(--fill-color);\n","    }\n","    30% {\n","      border-color: transparent;\n","      border-left-color: var(--fill-color);\n","      border-top-color: var(--fill-color);\n","      border-right-color: var(--fill-color);\n","    }\n","    40% {\n","      border-color: transparent;\n","      border-right-color: var(--fill-color);\n","      border-top-color: var(--fill-color);\n","    }\n","    60% {\n","      border-color: transparent;\n","      border-right-color: var(--fill-color);\n","    }\n","    80% {\n","      border-color: transparent;\n","      border-right-color: var(--fill-color);\n","      border-bottom-color: var(--fill-color);\n","    }\n","    90% {\n","      border-color: transparent;\n","      border-bottom-color: var(--fill-color);\n","    }\n","  }\n","</style>\n","\n","  <script>\n","    async function quickchart(key) {\n","      const quickchartButtonEl =\n","        document.querySelector('#' + key + ' button');\n","      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.\n","      quickchartButtonEl.classList.add('colab-df-spinner');\n","      try {\n","        const charts = await google.colab.kernel.invokeFunction(\n","            'suggestCharts', [key], {});\n","      } catch (error) {\n","        console.error('Error during call to suggestCharts:', error);\n","      }\n","      quickchartButtonEl.classList.remove('colab-df-spinner');\n","      quickchartButtonEl.classList.add('colab-df-quickchart-complete');\n","    }\n","    (() => {\n","      let quickchartButtonEl =\n","        document.querySelector('#df-e6e84ffa-0d9b-4e3e-874a-4bad73ea724d button');\n","      quickchartButtonEl.style.display =\n","        google.colab.kernel.accessAllowed ? 'block' : 'none';\n","    })();\n","  </script>\n","</div>\n","\n","    </div>\n","  </div>\n"],"text/plain":["        count  median      mean\n","star                           \n","1       83442     4.0  3.592157\n","2       34379     4.2  3.902624\n","3       88340     4.3  4.155666\n","4      199778     4.5  4.422135\n","5     1595399     4.8  4.695222"]},"execution_count":10,"metadata":{},"output_type":"execute_result"}],"source":["# df['star'].value_counts()\n","df.groupby('star')['rating_average'].agg(['count','median' , 'mean'])"]},{"cell_type":"code","execution_count":null,"metadata":{"cellView":"form","id":"ZGu-QT9A1SS5"},"outputs":[],"source":["# @title Ratin Average over Rating score Distribution\n","\n","import plotly.express as px\n","\n","# Assuming df is your dataframe containing 'star' and 'rating_average' columns\n","fig = px.box(df,\n","             x='star',\n","             y='rating_average',\n","             title='Distribution of Rating Average per Star Rating',\n","             labels={'star': 'Star Rating', 'rating_average': 'Rating Average'}\n","            )\n","\n","fig.show()"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"VsgNeR9CWxfl"},"outputs":[],"source":["df_merged['Label'] = ['SAD' if x in [1, 2] else 'HAPPY' for x in df_merged['star']]"]},{"cell_type":"code","source":["df_merged.to_csv('/content/drive/MyDrive/Basalam/Basalam_Comments&Products.csv')"],"metadata":{"id":"j7iVax3p_zsL"},"execution_count":null,"outputs":[]}],"metadata":{"colab":{"provenance":[],"mount_file_id":"1JxEBAJBai2qSAXPEn3vR-oZRHbw1VAuE","authorship_tag":"ABX9TyOqhlBYoUZ2pJzU+kiY0bLw"},"kernelspec":{"display_name":"Python 3","name":"python3"},"language_info":{"name":"python"}},"nbformat":4,"nbformat_minor":0}